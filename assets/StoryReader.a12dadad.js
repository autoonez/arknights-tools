var Tt=Object.defineProperty,kt=Object.defineProperties;var bt=Object.getOwnPropertyDescriptors;var oe=Object.getOwnPropertySymbols;var Be=Object.prototype.hasOwnProperty,Ve=Object.prototype.propertyIsEnumerable;var $e=(e,a,t)=>a in e?Tt(e,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[a]=t,y=(e,a)=>{for(var t in a||(a={}))Be.call(a,t)&&$e(e,t,a[t]);if(oe)for(var t of oe(a))Ve.call(a,t)&&$e(e,t,a[t]);return e},V=(e,a)=>kt(e,bt(a));var Ne=(e,a)=>{var t={};for(var n in e)Be.call(e,n)&&a.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&oe)for(var n of oe(e))a.indexOf(n)<0&&Ve.call(e,n)&&(t[n]=e[n]);return t};import{_ as R}from"./index.842ed7be.js";import{o as d,c as g,w as f,a as u,t as _,u as M,h as ae,v as ue,k as w,x as $,F as S,i as ne,m as J,y as ye,z as ve,A as G,B as k,C as xt,D as It,E as ke,G as z,H as be,R as Rt,I as xe,J as Ot,K as Lt,L as Ie,M as Dt,N as Pt,O as Qe,P as At,Q as Ze,S as wt,T as Re,U as $t,W as Bt,X as Vt,Y as Oe,Z as Nt,_ as Mt,$ as et,a0 as Ft,a1 as Le,a2 as tt,a3 as Yt,a4 as at,a5 as Me,a6 as se,a7 as W,a8 as Y,a9 as E,aa as H,ab as de,ac as re,ad as Q,ae as nt,af as Ht,ag as st,ah as Ut,ai as rt,aj as jt,ak as Wt,al as I,am as ge,an as qt,ao as zt,ap as Xt,aq as lt,ar as ot,as as it,at as De,au as ct,av as he,aw as Gt,ax as Kt,ay as ut,az as ie,aA as Jt,aB as Qt,aC as Zt,aD as ea,aE as dt,aF as ta,aG as aa,aH as na,r as D,aI as sa,aJ as ra,b as la,aK as oa,aL as ia,n as vt,j as ca,aM as _e,aN as mt,aO as ua,aP as da}from"./vendor.fb4d9537.js";const q="/arknights-assets",pe=[{id:"MAIN_STORY",name:"Main Theme"},{id:"ACTIVITY_STORY",name:"Public Affairs"},{id:"MINI_STORY",name:"Special Operation"},{id:"CHARACTER_STORY",name:"Operator Records"}],Fe=[{id:"zh_CN",name:"China"},{id:"en_US",name:"Global"},{id:"ja_JP",name:"Japan"},{id:"ko_KR",name:"Korea"},{id:"zh_TW",name:"Taiwan"}],va={emits:["SELECT_TYPE"],data(){return{storyTypeList:pe}}};function ma(e,a,t,n,s,r){return d(),g(J,null,{default:f(()=>[u(ne,null,{default:f(()=>[(d(!0),_(S,null,M(s.storyTypeList,(l,o)=>(d(),g(ae,{key:o,onClick:c=>this.$emit("SELECT_TYPE",l.id)},{default:f(()=>[u(ue,null,{default:f(()=>[w($(l.name),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})}var fa=R(va,[["render",ma]]);const ya={props:["items","server","type"],emits:["SELECT_HOME","SELECT_TYPE","SELECT_STORY_ID"],methods:{getStoryName(e){return`${e.code?`${e.code}: `:""}${e.name[this.server]}`}}},ga=w("mdi-home");function ha(e,a,t,n,s,r){return d(),_(S,null,[u(G,{variant:"text",class:ve({"d-none d-sm-inline-flex":t.type==="preview"}),onClick:a[0]||(a[0]=l=>this.$emit("SELECT_HOME"))},{default:f(()=>[u(ye,null,{default:f(()=>[ga]),_:1})]),_:1},8,["class"]),t.items.type?(d(),g(G,{key:0,variant:"text",class:ve({"d-none d-sm-inline-flex":t.type==="preview"}),onClick:a[1]||(a[1]=l=>this.$emit("SELECT_TYPE",t.items.type.id))},{default:f(()=>[w($(t.items.type.name),1)]),_:1},8,["class"])):k("",!0),t.items.episode?(d(),g(G,{key:1,variant:"text",class:ve({"d-none d-sm-inline-flex":t.type==="preview"}),onClick:a[2]||(a[2]=l=>this.$emit("SELECT_STORY_ID",t.items.episode.id))},{default:f(()=>[w($(t.items.episode.name[t.server]),1)]),_:1},8,["class"])):k("",!0),t.items.story?(d(),g(G,{key:2,variant:"text"},{default:f(()=>[w($(r.getStoryName(t.items.story)),1)]),_:1})):k("",!0)],64)}var _a=R(ya,[["render",ha]]);const pa={props:["storyByChapter","server"],emits:["SELECT_STORY_ID"],methods:{getEpisode(e){return`Episode ${e.split("_")[1]}`},getImageSrc(e){return`${q}/images/storyEntryPic/main/zone_page_${e}.png`}}};function Sa(e,a,t,n,s,r){return d(),g(J,null,{default:f(()=>[(d(!0),_(S,null,M(t.storyByChapter,(l,o)=>(d(),_(S,{key:o},[t.server in l.name?(d(),g(ne,{key:0},{default:f(()=>[u(xt,null,{default:f(()=>[w($(l.name[t.server]),1)]),_:2},1024),(d(!0),_(S,null,M(l.story,(c,v)=>(d(),g(ae,{key:v,"prepend-avatar":r.getImageSrc(c.id),onClick:m=>this.$emit("SELECT_STORY_ID",c.id)},{default:f(()=>[u(ke,null,{default:f(()=>[u(ue,null,{default:f(()=>[w($(r.getEpisode(c.id)),1)]),_:2},1024),u(It,null,{default:f(()=>[w($(c.name[t.server]),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["prepend-avatar","onClick"]))),128))]),_:2},1024)):k("",!0)],64))),128))]),_:1})}var Ea=R(pa,[["render",Sa]]);const Ca={props:["storyList","server"],emits:["SELECT_STORY_ID"],methods:{getImageSrc(e){return`${q}/images/storyEntryPic/activity/${e}.png`}}};function Ta(e,a,t,n,s,r){return d(),g(J,null,{default:f(()=>[u(ne,null,{default:f(()=>[(d(!0),_(S,null,M(t.storyList,(l,o)=>(d(),_(S,{key:o},[t.server in l.name?(d(),g(ae,{key:0,"prepend-avatar":r.getImageSrc(l.entryPic),onClick:c=>this.$emit("SELECT_STORY_ID",l.id)},{default:f(()=>[u(ke,null,{default:f(()=>[u(ue,null,{default:f(()=>[w($(l.name[t.server]),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["prepend-avatar","onClick"])):k("",!0)],64))),128))]),_:1})]),_:1})}var ka=R(Ca,[["render",Ta]]);const ba={props:["storyList","server"],emits:["SELECT_STORY_INDEX"],methods:{getStoryName(e){return`${e.code?`${e.code}: `:""}${e.name[this.server]}`}}};function xa(e,a,t,n,s,r){return d(),g(J,null,{default:f(()=>[u(ne,null,{default:f(()=>[(d(!0),_(S,null,M(t.storyList,(l,o)=>(d(),_(S,{key:o},[t.server in l.name?(d(),g(ae,{key:0,onClick:c=>this.$emit("SELECT_STORY_INDEX",l.sort)},{default:f(()=>[u(ke,null,{default:f(()=>[u(ue,null,{default:f(()=>[w($(r.getStoryName(l)),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"])):k("",!0)],64))),128))]),_:1})]),_:1})}var Ia=R(ba,[["render",xa]]);const Ra={props:["storyList","server"],emits:["SELECT_STORY_ID"],methods:{getImageSrc(e){return`${q}/images/avatar/${e}.png`}}};function Oa(e,a,t,n,s,r){return d(),g(J,null,{default:f(()=>[u(ne,null,{default:f(()=>[(d(!0),_(S,null,M(t.storyList,(l,o)=>(d(),_(S,{key:o},[t.server in l.name?(d(),g(ae,{key:0,"prepend-avatar":r.getImageSrc(l.character.id),onClick:c=>this.$emit("SELECT_STORY_ID",l.id),title:l.character.name[t.server],subtitle:l.name[t.server]},null,8,["prepend-avatar","onClick","title","subtitle"])):k("",!0)],64))),128))]),_:1})]),_:1})}var La=R(Ra,[["render",Oa]]);const Da=z("v-card-actions"),Ye=z("v-card-avatar"),Pa=z("v-card-header"),Aa=z("v-card-header-text"),wa=z("v-card-img"),$a=z("v-card-subtitle"),ft=z("v-card-text"),Ba=z("v-card-title"),Se=be({name:"VCard",directives:{Ripple:Rt},props:y(y(y(y(y(y(y(y(y(y({appendAvatar:String,appendIcon:String,disabled:Boolean,flat:Boolean,hover:Boolean,image:String,link:Boolean,prependAvatar:String,prependIcon:String,ripple:Boolean,subtitle:String,text:String,title:String},xe()),Ot()),Lt()),Ie()),Dt()),Pt()),Qe()),At()),Ze()),wt({variant:"contained"})),setup(e,a){let{attrs:t,slots:n}=a;const{themeClasses:s}=Re(e),{borderClasses:r}=$t(e,"v-card"),{colorClasses:l,colorStyles:o,variantClasses:c}=Bt(e,"v-card"),{densityClasses:v}=Vt(e,"v-card"),{dimensionStyles:m}=Oe(e),{elevationClasses:h}=Nt(e),{positionClasses:i,positionStyles:O}=Mt(e,"v-card"),{roundedClasses:F}=et(e,"v-card"),b=Ft(e,t);return()=>{var C,x,P;const T=b.isLink.value?"a":e.tag,U=!!(n.title||e.title),A=!!(n.subtitle||e.subtitle),j=U||A,B=!!(n.append||e.appendAvatar||e.appendIcon),N=!!(n.prepend||e.prependAvatar||e.prependIcon),p=!!(n.image||e.image),L=j||N||B,X=!!(n.text||e.text),K=!e.disabled&&(b.isClickable.value||e.link);return Le(u(T,{class:["v-card",{"v-card--disabled":e.disabled,"v-card--flat":e.flat,"v-card--hover":e.hover&&!(e.disabled||e.flat),"v-card--link":K},s.value,r.value,l.value,v.value,h.value,i.value,F.value,c.value],style:[o.value,m.value,O.value],href:b.href.value,onClick:K&&b.navigate},{default:()=>[Yt(K,"v-card"),p&&u(wa,null,{default:()=>[n.image?(C=n.image)==null?void 0:C.call(n,{src:e.image}):u(at,{src:e.image,cover:!0,alt:""},null,8,["src","cover"])]}),(x=n.media)==null?void 0:x.call(n),L&&u(Pa,null,{default:()=>[N&&u(Ye,null,{default:()=>[n.prepend?n.prepend():u(Me,{density:e.density,icon:e.prependIcon,image:e.prependAvatar},null,8,["density","icon","image"])]}),j&&u(Aa,null,{default:()=>[U&&u(Ba,null,{default:()=>[n.title?n.title():e.title]}),u($a,null,{default:()=>[n.subtitle?n.subtitle():e.subtitle]})],_:1}),B&&u(Ye,null,{default:()=>[n.append?n.append():u(Me,{density:e.density,icon:e.appendIcon,image:e.appendAvatar},null,8,["density","icon","image"])]})],_:1}),X&&u(ft,null,{default:()=>[n.text?n.text():e.text]}),(P=n.default)==null?void 0:P.call(n),n.actions&&u(Da,null,{default:n.actions})],_:1},8,["class","style","href","onClick"]),[[tt("ripple"),K]])}}});const Va=se({closeDelay:[Number,String],openDelay:[Number,String]},"delay");function Na(e,a){const t={},n=s=>()=>{if(!W)return Promise.resolve(!0);const r=s==="openDelay";return t.closeDelay&&window.clearTimeout(t.closeDelay),delete t.closeDelay,t.openDelay&&window.clearTimeout(t.openDelay),delete t.openDelay,new Promise(l=>{var o;const c=parseInt((o=e[s])!=null?o:0,10);t[s]=window.setTimeout(()=>{a==null||a(r),l(r)},c)})};return{runCloseDelay:n("closeDelay"),runOpenDelay:n("openDelay")}}const Ma=se(y({activator:[String,Object],activatorProps:{type:Object,default:()=>({})},openOnClick:{type:Boolean,default:void 0},openOnHover:Boolean,openOnFocus:{type:Boolean,default:void 0}},Va()));function Fa(e,a){const t=Y();let n=!1,s=!1;const r=E(()=>e.openOnFocus||e.openOnFocus==null&&e.openOnHover),l=E(()=>e.openOnClick||e.openOnClick==null&&!e.openOnHover&&!r.value),{runOpenDelay:o,runCloseDelay:c}=Na(e,i=>{i===(e.openOnHover&&n||r.value&&s)&&(a.value=i)}),v={click:i=>{i.stopPropagation(),t.value=i.currentTarget||i.target,a.value=!a.value},mouseenter:i=>{n=!0,o()},mouseleave:i=>{n=!1,c()},focus:i=>{Ht&&!i.target.matches(":focus-visible")||(s=!0,i.stopPropagation(),o())},blur:i=>{s=!1,i.stopPropagation(),c()}},m=E(()=>{const i={};return l.value&&(i.click=v.click),e.openOnHover&&(i.mouseenter=v.mouseenter,i.mouseleave=v.mouseleave),r.value&&(i.focus=v.focus,i.blur=v.blur),i});let h;return H(()=>!!e.activator,i=>{i&&W?(h=de(),h.run(()=>{Ya(e,{activatorEl:t,activatorEvents:m})})):h&&h.stop()},{flush:"post",immediate:!0}),{activatorEl:t,activatorEvents:m}}function Ya(e,a){let{activatorEl:t,activatorEvents:n}=a;H(()=>e.activator,(c,v)=>{if(v&&c!==v){const m=o(v);m&&r(m)}c&&re(()=>s())},{immediate:!0}),H(()=>e.activatorProps,()=>{s()}),Q(()=>{r()});function s(){let c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:o(),v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e.activatorProps;!c||(Object.entries(n.value).forEach(m=>{let[h,i]=m;c.addEventListener(h,i)}),Object.keys(v).forEach(m=>{v[m]==null?c.removeAttribute(m):c.setAttribute(m,v[m])}))}function r(){let c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:o(),v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e.activatorProps;!c||(Object.entries(n.value).forEach(m=>{let[h,i]=m;c.removeEventListener(h,i)}),Object.keys(v).forEach(m=>{c.removeAttribute(m)}))}const l=nt("useActivator");function o(){var c;let v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:e.activator,m;if(v)if(v==="parent"){var h,i;m=l==null||(h=l.proxy)==null||(i=h.$el)==null?void 0:i.parentNode}else typeof v=="string"?m=document.querySelector(v):"$el"in v?m=v.$el:m=v;return t.value=((c=m)==null?void 0:c.nodeType)===Node.ELEMENT_NODE?m:null,t.value}}function He(e){let[a,t]=e.split(" ");return t||(t=a==="top"||a==="bottom"?"start":a==="start"||a==="end"?"top":"center"),{side:a,align:t}}function me(e){return{side:{center:"center",top:"bottom",bottom:"top",start:"end",end:"start"}[e.side],align:e.align}}function Ue(e,a){var t,n;const{side:s,align:r}=e,{direction:l}=window.getComputedStyle(a),o=l==="ltr"?{start:"left",end:"right"}:{start:"right",end:"left"};return((t=o[s])!=null?t:s)+" "+((n=o[r])!=null?n:r)}function fe(e,a){return{x:e.x+a.x,y:e.y+a.y}}function Ha(e,a){return{x:e.x-a.x,y:e.y-a.y}}function je(e,a){if(e.side==="top"||e.side==="bottom"){const{side:t,align:n}=e,s=n==="start"?0:n==="center"?a.width/2:n==="end"?a.width:n,r=t==="top"?0:t==="bottom"?a.height:t;return fe({x:s,y:r},a)}else if(e.side==="start"||e.side==="end"){const{side:t,align:n}=e,s=t==="start"?0:t==="end"?a.width:t,r=n==="top"?0:n==="center"?a.height/2:n==="bottom"?a.height:n;return fe({x:s,y:r},a)}return fe({x:a.width/2,y:a.height/2},a)}const yt={static:Wa,connected:qa},Ua=se({positionStrategy:{type:[String,Function],default:"static",validator:e=>typeof e=="function"||e in yt},anchor:{type:String,default:"bottom"},origin:{type:String,default:"auto"},offset:[Number,String]});function ja(e,a){const t=Y({}),n=Y();let s;st(async()=>{var l;(l=s)==null||l.stop(),n.value=void 0,!!(W&&a.isActive.value&&e.positionStrategy)&&(s=de(),await re(),s.run(()=>{if(typeof e.positionStrategy=="function"){var o;n.value=(o=e.positionStrategy(a,e,t))==null?void 0:o.updatePosition}else{var c;n.value=(c=yt[e.positionStrategy](a,e,t))==null?void 0:c.updatePosition}}))}),W&&window.addEventListener("resize",r,{passive:!0}),Q(()=>{var l;W&&window.removeEventListener("resize",r),n.value=void 0,(l=s)==null||l.stop()});function r(l){var o;(o=n.value)==null||o.call(n,l)}return{contentStyles:t,updatePosition:n}}function Wa(){}function qa(e,a,t){const n=Ut(e.activatorEl.value);n&&Object.assign(t.value,{position:"fixed"});const s=E(()=>He(a.anchor)),r=E(()=>a.origin==="overlap"?s.value:a.origin==="auto"?me(s.value):He(a.origin)),l=E(()=>s.value.side===r.value.side),o=E(()=>{const i=parseFloat(a.maxHeight);return isNaN(i)?1/0:i}),c=E(()=>{const i=parseFloat(a.minWidth);return isNaN(i)?1/0:i});let v=!1;const m=new ResizeObserver(()=>{v&&h()});m.observe(e.activatorEl.value),m.observe(e.contentEl.value),Q(()=>{m.disconnect()});function h(){v=!1,requestAnimationFrame(()=>{requestAnimationFrame(()=>v=!0)});const i=e.activatorEl.value.getBoundingClientRect();a.offset&&(i.x-=+a.offset,i.y-=+a.offset,i.width+=+a.offset*2,i.height+=+a.offset*2);const O=rt(e.contentEl.value),F=O.clientWidth,b=Math.min(O.clientHeight,window.innerHeight);let C;{const Ae=new Map;e.contentEl.value.querySelectorAll("*").forEach(Z=>{const le=Z.scrollLeft,we=Z.scrollTop;(le||we)&&Ae.set(Z,[le,we])});const Et=e.contentEl.value.style.maxWidth,Ct=e.contentEl.value.style.maxHeight;e.contentEl.value.style.removeProperty("max-width"),e.contentEl.value.style.removeProperty("max-height"),C=jt(e.contentEl.value),C.x-=parseFloat(e.contentEl.value.style.left)||0,C.y-=parseFloat(e.contentEl.value.style.top)||0,e.contentEl.value.style.maxWidth=Et,e.contentEl.value.style.maxHeight=Ct,Ae.forEach((Z,le)=>{le.scrollTo(...Z)})}const x=Math.min(o.value,C.height),P=12,T={top:i.top-P,bottom:b-i.bottom-P,left:i.left-P,right:F-i.right-P},U=s.value.side==="bottom"&&x<=T.bottom||s.value.side==="top"&&x<=T.top,A=U?s.value:s.value.side==="bottom"&&T.top>T.bottom||s.value.side==="top"&&T.bottom>T.top?me(s.value):s.value,j=U?r.value:me(A),N=l.value||["center","top","bottom"].includes(A.side)?Math.min(F,Math.max(i.width,F-P*2)):A.side==="end"?T.right:A.side==="start"?T.left:null,p=Math.min(c.value,N,i.width),L=U?o.value:Math.min(o.value,Math.floor(A.side==="top"?T.top:T.bottom)),X=je(A,i),K=je(j,new Wt(V(y({},C),{height:Math.min(x,L)}))),{x:pt,y:St}=Ha(X,K);Object.assign(t.value,{"--v-overlay-anchor-origin":Ue(A,e.activatorEl.value),top:I(Math.round(St)),left:I(Math.round(pt)),transformOrigin:Ue(j,e.activatorEl.value),minWidth:I(p),maxWidth:I(N),maxHeight:I(L)})}return H(()=>[s.value,r.value,a.offset],()=>h(),{immediate:!n}),n&&re(()=>h()),requestAnimationFrame(()=>{t.value.maxHeight&&h()}),{updatePosition:h}}let Ee=!0;const ce=[];function za(e){!Ee||ce.length?(ce.push(e),Ce()):(Ee=!1,e(),Ce())}let We=-1;function Ce(){cancelAnimationFrame(We),We=requestAnimationFrame(()=>{const e=ce.shift();e&&e(),ce.length?Ce():Ee=!0})}const Te={close:Ka,block:Ja,reposition:Qa},Xa=se({scrollStrategy:{type:[String,Function],default:"block",validator:e=>typeof e=="function"||e in Te}});function Ga(e,a){if(!W)return;let t;st(async()=>{var n;(n=t)==null||n.stop(),!!(a.isActive.value&&e.scrollStrategy)&&(t=de(),await re(),t.run(()=>{if(typeof e.scrollStrategy=="function")e.scrollStrategy(a);else{var s;(s=Te[e.scrollStrategy])==null||s.call(Te,a)}}))})}function Ka(e){var a;function t(n){e.isActive.value=!1}gt((a=e.activatorEl.value)!=null?a:e.contentEl.value,t)}function Ja(e){var a;const t=[...new Set([...ge(e.activatorEl.value),...ge(e.contentEl.value)])].filter(r=>!r.classList.contains("v-overlay-scroll-blocked")),n=window.innerWidth-document.documentElement.offsetWidth,s=(r=>qt(r)&&r)(((a=e.root.value)==null?void 0:a.offsetParent)||document.documentElement);s&&e.root.value.classList.add("v-overlay--scroll-blocked"),t.forEach((r,l)=>{r.style.setProperty("--v-scrollbar-offset",I(n)),r.classList.add("v-overlay-scroll-blocked")}),Q(()=>{t.forEach((r,l)=>{r.style.removeProperty("--v-scrollbar-offset"),r.classList.remove("v-overlay-scroll-blocked")}),s&&e.root.value.classList.remove("v-overlay--scroll-blocked")})}function Qa(e){var a;let t=!1,n=-1;function s(r){za(()=>{var l,o;const c=performance.now();(l=(o=e.updatePosition).value)==null||l.call(o,r),t=(performance.now()-c)/(1e3/60)>2})}gt((a=e.activatorEl.value)!=null?a:e.contentEl.value,r=>{t?(cancelAnimationFrame(n),n=requestAnimationFrame(()=>{n=requestAnimationFrame(()=>{s(r)})})):s(r)})}function gt(e,a){const t=[document,...ge(e)];t.forEach(n=>{n.addEventListener("scroll",a,{passive:!0})}),Q(()=>{t.forEach(n=>{n.removeEventListener("scroll",a)})})}function te(e){return{teleportTarget:E(()=>{const t=e.value;if(t===!0||!W)return;const n=t===!1?document.body:typeof t=="string"?document.querySelector(t):t;if(n==null){zt(`Unable to locate target ${t}`);return}if(!te.cache.has(n)){const s=document.createElement("div");s.className="v-overlay-container",n.appendChild(s),te.cache.set(n,s)}return te.cache.get(n)})}}te.cache=new WeakMap;const Za=se({eager:Boolean},"lazy");function en(e,a){const t=Y(!1),n=E(()=>t.value||e.eager||a.value);H(a,()=>t.value=!0);function s(){e.eager||(t.value=!1)}return{isBooted:t,hasContent:n,onAfterLeave:s}}const ee=Y([]);function tn(e){const a=nt("useStack");let t;return H(e,s=>{if(s)t=de(),t.run(()=>{ee.value.push(a),Q(()=>{const l=ee.value.indexOf(a);ee.value.splice(l,1)})});else{var r;(r=t)==null||r.stop()}},{immediate:!0}),{isTop:E(()=>Xt(ee.value[ee.value.length-1])===a)}}function an(){return!0}function ht(e,a,t){if(!e||_t(e,t)===!1)return!1;const n=lt(a);if(typeof ShadowRoot!="undefined"&&n instanceof ShadowRoot&&n.host===e.target)return!1;const s=(typeof t.value=="object"&&t.value.include||(()=>[]))();return s.push(a),!s.some(r=>r==null?void 0:r.contains(e.target))}function _t(e,a){return(typeof a.value=="object"&&a.value.closeConditional||an)(e)}function nn(e,a,t){const n=typeof t.value=="function"?t.value:t.value.handler;a._clickOutside.lastMousedownWasOutside&&ht(e,a,t)&&setTimeout(()=>{_t(e,t)&&n&&n(e)},0)}function qe(e,a){const t=lt(e);a(document),typeof ShadowRoot!="undefined"&&t instanceof ShadowRoot&&a(t)}const sn={mounted(e,a){const t=s=>nn(s,e,a),n=s=>{e._clickOutside.lastMousedownWasOutside=ht(s,e,a)};qe(e,s=>{s.addEventListener("click",t,!0),s.addEventListener("mousedown",n,!0)}),e._clickOutside||(e._clickOutside={lastMousedownWasOutside:!0}),e._clickOutside[a.instance.$.uid]={onClick:t,onMousedown:n}},unmounted(e,a){!e._clickOutside||(qe(e,t=>{var n;if(!t||!((n=e._clickOutside)!=null&&n[a.instance.$.uid]))return;const{onClick:s,onMousedown:r}=e._clickOutside[a.instance.$.uid];t.removeEventListener("click",s,!0),t.removeEventListener("mousedown",r,!0)}),delete e._clickOutside[a.instance.$.uid])}};function rn(e){const s=e,{modelValue:a,color:t}=s,n=Ne(s,["modelValue","color"]);return u(dt,{name:"fade-transition",appear:!0},{default:()=>[e.modelValue&&u("div",ie({class:["v-overlay__scrim",e.color.backgroundColorClasses.value],style:e.color.backgroundColorStyles.value},n),null,16)]},8,["appear"])}const ln=ot()({name:"VOverlay",directives:{ClickOutside:sn},inheritAttrs:!1,props:y(y(y(y(y(y(y({absolute:Boolean,attach:[Boolean,String,Object],contained:Boolean,contentClass:null,noClickAnimation:Boolean,modelValue:Boolean,persistent:Boolean,scrim:{type:[String,Boolean],default:!0}},Ma()),Ie()),Ua()),Xa()),xe()),it()),Za()),emits:{"click:outside":e=>!0,"update:modelValue":e=>!0},setup(e,a){let{slots:t,attrs:n,emit:s}=a;const r=De(e,"modelValue"),{teleportTarget:l}=te(E(()=>e.attach||e.contained)),{themeClasses:o}=Re(e),{rtlClasses:c}=ct(),{hasContent:v,onAfterLeave:m}=en(e,r),h=he(E(()=>typeof e.scrim=="string"?e.scrim:null)),{activatorEl:i,activatorEvents:O}=Fa(e,r),{dimensionStyles:F}=Oe(e),{isTop:b}=tn(r),C=Y(),x=Y(),{contentStyles:P,updatePosition:T}=ja(e,{contentEl:x,activatorEl:i,isActive:r});Ga(e,{root:C,contentEl:x,activatorEl:i,isActive:r,updatePosition:T});function U(p){s("click:outside",p),e.persistent?N():r.value=!1}function A(){return r.value&&b.value}H(r,p=>{p?window.addEventListener("keydown",j):window.removeEventListener("keydown",j)},{immediate:!0});function j(p){p.key==="Escape"&&b.value&&(e.persistent?N():r.value=!1)}Gt(p=>{b.value&&r.value?(p(!1),e.persistent?N():r.value=!1):p()});const B=Y();H(()=>r.value&&(e.absolute||e.contained)&&l.value==null,p=>{if(p){const L=rt(C.value);L&&L!==document.scrollingElement&&(B.value=L.scrollTop)}});function N(){var p;e.noClickAnimation||(p=x.value)==null||p.animate([{transformOrigin:"center"},{transform:"scale(1.03)"},{transformOrigin:"center"}],{duration:150,easing:Kt})}return ut(()=>{var p,L;return u(S,null,[(p=t.activator)==null?void 0:p.call(t,{isActive:r.value,props:ie({modelValue:r.value,"onUpdate:modelValue":X=>r.value=X},Jt(O.value),e.activatorProps)}),u(Qt,{disabled:!l.value,to:l.value},{default:()=>[v.value&&u("div",ie({class:["v-overlay",{"v-overlay--absolute":e.absolute||e.contained,"v-overlay--active":r.value,"v-overlay--contained":e.contained},o.value,c.value],style:B.value!=null?`top: ${I(B.value)}`:void 0,ref:C},n),[u(rn,{color:h,modelValue:r.value&&!!e.scrim},null,8,["color","modelValue"]),u(Zt,{appear:!0,onAfterLeave:m,persisted:!0,transition:e.transition,target:i.value},{default:()=>[Le(u("div",{ref:x,class:["v-overlay__content",e.contentClass],style:[F.value,P.value]},[(L=t.default)==null?void 0:L.call(t,{isActive:r})],6),[[ea,r.value],[tt("click-outside"),{handler:U,closeConditional:A,include:()=>[i.value]}]])]},8,["appear","onAfterLeave","persisted","transition","target"])],16)]},8,["disabled","to"])])}),{animateClick:N,contentEl:x,activatorEl:i}}}),on=ot()({name:"VDialog",inheritAttrs:!1,props:y(y({fullscreen:Boolean,origin:{type:String,default:"center center"},retainFocus:{type:Boolean,default:!0},scrollable:Boolean,modelValue:Boolean},Ie({width:"auto"})),it({transition:{component:ta}})),emits:{"update:modelValue":e=>!0},setup(e,a){let{attrs:t,slots:n}=a;const s=De(e,"modelValue"),{dimensionStyles:r}=Oe(e),l=Y();function o(c){var v;const m=c.relatedTarget,h=c.target;if(m!==h&&(v=l.value)!=null&&v.contentEl&&![document,l.value.contentEl].includes(h)&&!l.value.contentEl.contains(h)){const i=[...l.value.contentEl.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])')].filter(b=>!b.hasAttribute("disabled"));if(!i.length)return;const O=i[0],F=i[i.length-1];m===O?F.focus():O.focus()}}return W&&H(()=>s.value&&e.retainFocus,c=>{c?document.addEventListener("focusin",o):document.removeEventListener("focusin",o)},{immediate:!0}),H(s,async c=>{if(await re(),c){var v;(v=l.value.contentEl)==null||v.focus({preventScroll:!0})}else{var m;(m=l.value.activatorEl)==null||m.focus({preventScroll:!0})}}),()=>u(ln,ie({modelValue:s.value,"onUpdate:modelValue":c=>s.value=c,class:["v-dialog",{"v-dialog--fullscreen":e.fullscreen}],style:r.value,transition:e.transition,ref:l,"aria-role":"dialog","aria-modal":"true",activatorProps:{"aria-haspopup":"dialog","aria-expanded":String(s.value)}},t),{default:n.default,activator:n.activator},16,["modelValue","onUpdate:modelValue","class","style","transition","activatorProps"])}});const cn=be({name:"VLayout",props:aa(),setup(e,a){let{slots:t}=a;const{layoutClasses:n,getLayoutItem:s,items:r}=na(e);return ut(()=>{var l;return u("div",{class:n.value},[(l=t.default)==null?void 0:l.call(t)],2)}),{getLayoutItem:s,items:r}}}),un={props:["storyTable"],emits:["selectFile"],data(){return{dialog:!1,ready:!1,stage:"SELECT_TYPE",story:{type:"",id:"",index:1},server:"en_US",serverList:Fe}},created(){this.$watch(()=>[this.$route.query.storyType,this.$route.query.storyId,this.$route.query.storyIndex,this.$route.query.server],()=>{this.getUrlQuery()},{immediate:!0})},computed:{stageComponent(){let e="TYPE";return this.stage==="SELECT_STORY_ID"&&this.story.type==="MAIN_STORY"&&(e="MAIN"),this.stage==="SELECT_STORY_ID"&&["ACTIVITY_STORY","MINI_STORY"].includes(this.story.type)&&(e="ACTIVITY"),this.stage==="SELECT_STORY_ID"&&this.story.type==="CHARACTER_STORY"&&(e="CHARACTER"),this.stage==="SELECT_STORY_INDEX"&&(e="INDEX"),e}},methods:{getUrlQuery(){let e=this.$route.query,a=!1,t="en_US",n;if(e.server&&Fe.find(s=>s.id===e.server)&&(this.server=e.server),t=e.server,e.storyType&&pe.find(s=>s.id===e.storyType)){let s=e.storyType;if(this.story.type=s,e.storyId&&e.storyId in this.storyTable.story[s]){let r=e.storyId,l=this.storyTable.story[s][r];if(t in l.name){this.story.id=r;let o;e.storyIndex&&(o=l.story.find(c=>c.sort===parseInt(e.storyIndex)))&&(this.story.index=o.sort,n=o.file,a=!0)}}}a?this.$emit("selectFile",{file:n,server:this.server}):this.dialog=!0},getMainStoryByChapter(){let e=Object.entries(this.storyTable.story.MAIN_STORY).reduce((a,[t,n])=>{if(!(n.chapter in a)){let s=this.storyTable.data.chapter[n.chapter];a[n.chapter]={id:n.chapter,name:s.name,story:[]}}return a[n.chapter].story.push(V(y({},n),{id:t})),a},{});return Object.values(e)},getActivityStoryList(){return Object.entries(this.storyTable.story[this.story.type]).map(([e,a])=>V(y({},a),{id:e}))},getCharacterStoryList(){return Object.entries(this.storyTable.story.CHARACTER_STORY).map(([e,a])=>{let t=this.storyTable.data.character[a.character];return V(y({},a),{id:e,character:{id:a.character,name:t.name}})})},getStoryList(){return this.storyTable.story[this.story.type][this.story.id].story},getBreadcrumbItems(){let e,a,t;return e=pe.find(n=>n.id===this.story.type),e&&(a=this.storyTable.story[this.story.type][this.story.id]),a&&(t=a.story.find(n=>n.sort===this.story.index)),{type:e,episode:a?V(y({},a),{id:this.story.id}):void 0,story:t?V(y({},t),{index:this.story.index}):void 0}},selectHome(){this.ready=!1,this.stage="SELECT_TYPE",this.story={}},selectType(e){this.ready=!1,this.stage="SELECT_STORY_ID",this.story={type:e}},selectStoryId(e){this.ready=!1,this.stage="SELECT_STORY_INDEX",this.story={type:this.story.type,id:e}},selectStoryIndex(e){this.story={type:this.story.type,id:this.story.id,index:e},this.ready=!0},select(){this.dialog=!1,this.$router.push({path:"/story-reader",query:{storyType:this.story.type,storyId:this.story.id,storyIndex:this.story.index,server:this.server}})}},components:{StorySelectorType:fa,StorySelectorBreadcrumb:_a,StorySelectorMain:Ea,StorySelectorActivity:ka,StorySelectorIndex:Ia,StorySelectorCharacter:La}},dn=w("mdi-close"),vn=w("mdi-earth"),mn=["value"],fn=w("Select");function yn(e,a,t,n,s,r){const l=D("StorySelectorBreadcrumb"),o=D("StorySelectorType"),c=D("StorySelectorMain"),v=D("StorySelectorActivity"),m=D("StorySelectorCharacter"),h=D("StorySelectorIndex");return d(),g(on,{modelValue:s.dialog,"onUpdate:modelValue":a[3]||(a[3]=i=>s.dialog=i),fullscreen:"",scrim:!1,transition:"dialog-bottom-transition"},{activator:f(({props:i})=>[u(Se,sa(ra(i)),{default:f(()=>[u(l,{items:r.getBreadcrumbItems(),server:s.server,type:"preview"},null,8,["items","server"])]),_:2},1040)]),default:f(()=>[u(Se,null,{default:f(()=>[u(cn,null,{default:f(()=>[u(la,{density:"compact"},{default:f(()=>[u(G,{icon:"",dark:"",onClick:a[0]||(a[0]=i=>s.dialog=!1)},{default:f(()=>[u(ye,null,{default:f(()=>[dn]),_:1})]),_:1}),u(l,{items:r.getBreadcrumbItems(),server:s.server,onSELECT_HOME:r.selectHome,onSELECT_TYPE:r.selectType},null,8,["items","server","onSELECT_HOME","onSELECT_TYPE"]),u(oa),u(ye,null,{default:f(()=>[vn]),_:1}),Le(vt("select",{"onUpdate:modelValue":a[1]||(a[1]=i=>s.server=i)},[(d(!0),_(S,null,M(s.serverList,(i,O)=>(d(),_("option",{key:O,value:i.id},$(i.name),9,mn))),128))],512),[[ia,s.server]]),u(G,{disabled:!s.ready,text:"",onClick:a[2]||(a[2]=i=>r.select())},{default:f(()=>[fn]),_:1},8,["disabled"])]),_:1}),u(ca,null,{default:f(()=>[r.stageComponent==="TYPE"?(d(),g(o,{key:0,onSELECT_TYPE:r.selectType},null,8,["onSELECT_TYPE"])):k("",!0),r.stageComponent==="MAIN"?(d(),g(c,{key:1,storyByChapter:r.getMainStoryByChapter(),server:s.server,onSELECT_STORY_ID:r.selectStoryId},null,8,["storyByChapter","server","onSELECT_STORY_ID"])):k("",!0),r.stageComponent==="ACTIVITY"?(d(),g(v,{key:2,storyList:r.getActivityStoryList(),server:s.server,onSELECT_STORY_ID:r.selectStoryId},null,8,["storyList","server","onSELECT_STORY_ID"])):k("",!0),r.stageComponent==="CHARACTER"?(d(),g(m,{key:3,storyList:r.getCharacterStoryList(),server:s.server,onSELECT_STORY_ID:r.selectStoryId},null,8,["storyList","server","onSELECT_STORY_ID"])):k("",!0),r.stageComponent==="INDEX"?(d(),g(h,{key:4,storyList:r.getStoryList(),server:s.server,onSELECT_STORY_INDEX:r.selectStoryIndex},null,8,["storyList","server","onSELECT_STORY_INDEX"])):k("",!0)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}var gn=R(un,[["render",yn]]);const ze=/\[(?<tag>.+?)\((?<params>.*)\)\]/,Xe=/\[(?<tag>.*)=(?<value>.*)\]/g,Ge=/\[(?<tag>.*)\]/,Ke=/(?<name>\w*?)\s*=\s*(?<value>".*?"|[^",)\]\s]*)/g,Je=/\[[Nn][Aa][Mm][Ee]="(?<name>.*)"(?<params>.*)\]\s*(?<text>.*)/g,hn=e=>{let a={lines:[],tagCount:{},otherLines:[]},t=e.split(`
`),n=s=>{s in a.tagCount||(a.tagCount[s]=0),a.tagCount[s]+=1};for(const s of t)if(s.match(ze)){let{tag:r,params:l}=ze.exec(s).groups;r=r.toUpperCase();let o={},c;for(;(c=Ke.exec(l))!==null;){let{name:v,value:m}=c.groups;o[v]=m.replace(/"/g,"")}a.lines.push({tag:r,params:o}),n(r)}else if(s.match(Je)){let{name:r,params:l,text:o}=Je.exec(s).groups,c={},v;for(;(v=Ke.exec(l))!==null;){let{name:m,value:h}=v.groups;c[m]=h.replace(/"/g,"")}a.lines.push({tag:"CHARACTER_SPEECH",params:V(y({},c),{name:r,text:o})}),n("CHARACTER_SPEECH")}else if(s.match(Xe)){let{tag:r,value:l}=Xe.exec(s).groups;r=r.toUpperCase(),a.lines.push({tag:r,params:{[r]:l}}),n(r)}else if(s.match(Ge)){let{tag:r}=Ge.exec(s).groups;r=r.toUpperCase(),a.lines.push({tag:r,params:{}}),n(r)}else if(s.length>0&&s.indexOf("//"!==0)){let r="DESCRIPTION";a.lines.push({tag:r,params:{text:s}}),n(r)}else a.otherLines.push(s);return a},_n={props:["line"]};function pn(e,a,t,n,s,r){return d(),g(Se,{class:"my-3"},{default:f(()=>[u(ft,null,{default:f(()=>[(d(!0),_(S,null,M(t.line.params.text,(l,o)=>(d(),_("p",{key:o},$(l),1))),128))]),_:1})]),_:1})}var Sn=R(_n,[["render",pn]]);const En={props:["line"]},Cn={class:"font-weight-bold text-grey"};function Tn(e,a,t,n,s,r){return d(),g(mt,{class:"my-3"},{default:f(()=>[u(_e,{cols:"12",sm:"2",class:"pb-0 pb-sm-3"},{default:f(()=>[vt("p",Cn,$(t.line.params.name),1)]),_:1}),u(_e,{cols:"12",sm:"8",class:"pt-0 pt-sm-3"},{default:f(()=>[(d(!0),_(S,null,M(t.line.params.text,(l,o)=>(d(),_("p",{key:o},$(l),1))),128))]),_:1})]),_:1})}var kn=R(En,[["render",Tn]]);const bn={props:["line","decision"],emits:["selectDecision"],methods:{getVariant(e){let a="contained";return(this.decision[this.line.params.id]||this.line.params.options[0].value)===e&&(a="outlined"),a},selectDecision(e){this.$emit("selectDecision",{id:this.line.params.id,value:e})}}};function xn(e,a,t,n,s,r){return d(),g(mt,{dense:""},{default:f(()=>[(d(!0),_(S,null,M(t.line.params.options,(l,o)=>(d(),g(_e,{cols:"12",key:o},{default:f(()=>[u(G,{class:"float-right text-right",variant:r.getVariant(l.value),onClick:c=>r.selectDecision(l.value)},{default:f(()=>[w($(l.text),1)]),_:2},1032,["variant","onClick"])]),_:2},1024))),128))]),_:1})}var In=R(bn,[["render",xn]]);const Rn={props:["line"],computed:{imageSrc(){let e="";return this.line.tag==="IMAGE"&&(e=`${q}/images/avg/imgs/${this.line.params.image}.png`),this.line.tag==="BACKGROUND"&&(e=`${q}/images/avg/bg/${this.line.params.image}.png`),this.line.params.image||(e=e=`${q}/images/avg/bg/bg_black.png`),e}}};function On(e,a,t,n,s,r){return d(),g(at,{src:r.imageSrc,class:"my-3"},null,8,["src"])}var Ln=R(Rn,[["render",On]]);const Dn={props:["line","decision"],emits:["selectDecision"],methods:{selectDecision(e){this.$emit("selectDecision",e)}},components:{TagDescription:Sn,TagCharacterSpeech:kn,TagDecision:In,TagImage:Ln}};function Pn(e,a,t,n,s,r){const l=D("TagDescription"),o=D("TagCharacterSpeech"),c=D("TagDecision"),v=D("TagImage");return t.line.tag==="DESCRIPTION"?(d(),g(l,{key:0,line:t.line},null,8,["line"])):t.line.tag==="CHARACTER_SPEECH"?(d(),g(o,{key:1,line:t.line},null,8,["line"])):t.line.tag==="DECISION"?(d(),g(c,{key:2,line:t.line,decision:t.decision,onSelectDecision:r.selectDecision},null,8,["line","decision","onSelectDecision"])):["IMAGE","BACKGROUND"].includes(t.line.tag)?(d(),g(v,{key:3,line:t.line},null,8,["line"])):k("",!0)}var An=R(Dn,[["render",Pn]]);const wn={props:["renderBlock"],data(){return{decision:{}}},methods:{selectDecision({id:e,value:a}){this.decision[e]=a}},computed:{items(){let e=[],a=1,t;for(let n=0;n<this.renderBlock.length;n++){let s=this.renderBlock[n];switch(s.tag){case"DECISION":{t=this.decision[a]||s.params.options[0].value,s.params.id=a,e.push(s),a+=1;break}case"PREDICATE":{if(s.params.references.includes(t))t=null;else for(let r=n+1;r<this.renderBlock.length;r++)if(this.renderBlock[r].tag==="PREDICATE"){n=r-1;break}else if(r===this.renderBlock.length-1){n=r;break}break}default:{e.push(s);break}}}return e}},components:{StoryReaderRenderItem:An}};function $n(e,a,t,n,s,r){const l=D("StoryReaderRenderItem");return d(!0),_(S,null,M(r.items,(o,c)=>(d(),g(l,{key:c,line:o,decision:s.decision,onSelectDecision:r.selectDecision},null,8,["line","decision","onSelectDecision"]))),128)}var Bn=R(wn,[["render",$n]]);function Vn(e){const a=Y(),t=Y(!1),n=new IntersectionObserver(s=>{e==null||e(s,n),t.value=!!s.find(r=>r.isIntersecting)});return ua(()=>{n.disconnect()}),H(a,(s,r)=>{r&&(n.unobserve(r),t.value=!1),s&&n.observe(s)},{flush:"post"}),{intersectionRef:a,isIntersecting:t}}const Pe=be({name:"VProgressLinear",props:y(y(y({active:{type:Boolean,default:!0},bgColor:String,bgOpacity:[Number,String],bufferValue:{type:[Number,String],default:0},clickable:Boolean,color:String,height:{type:[Number,String],default:4},indeterminate:Boolean,max:{type:[Number,String],default:100},modelValue:{type:[Number,String],default:0},reverse:Boolean,stream:Boolean,striped:Boolean,roundedBar:Boolean},Qe()),Ze()),xe()),emits:{"update:modelValue":e=>!0},setup(e,a){let{slots:t}=a;const n=De(e,"modelValue"),{isRtl:s}=ct(),{themeClasses:r}=Re(e),{textColorClasses:l,textColorStyles:o}=da(e,"color"),{backgroundColorClasses:c,backgroundColorStyles:v}=he(E(()=>e.bgColor||e.color)),{backgroundColorClasses:m,backgroundColorStyles:h}=he(e,"color"),{roundedClasses:i}=et(e,"v-progress-linear"),{intersectionRef:O,isIntersecting:F}=Vn(),b=E(()=>parseInt(e.max,10)),C=E(()=>parseInt(e.height,10)),x=E(()=>Math.round(parseFloat(e.bufferValue)/b.value*100)),P=E(()=>Math.round(parseFloat(n.value)/b.value*100)),T=E(()=>s.value!==e.reverse),U=E(()=>e.indeterminate?"fade-transition":"slide-x-transition"),A=E(()=>e.bgOpacity==null?e.bgOpacity:parseFloat(e.bgOpacity));function j(B){if(!O.value)return;const{left:N,right:p,width:L}=O.value.getBoundingClientRect(),X=T.value?L-B.clientX+(p-L):B.clientX-N;n.value=Math.round(X/L*b.value)}return()=>u(e.tag,{ref:O,class:["v-progress-linear",{"v-progress-linear--active":e.active&&F.value,"v-progress-linear--reverse":T.value,"v-progress-linear--rounded":e.rounded,"v-progress-linear--rounded-bar":e.roundedBar,"v-progress-linear--striped":e.striped},i.value,r.value],style:{height:e.active?I(C.value):0,"--v-progress-linear-height":I(C.value)},role:"progressbar","aria-valuemin":"0","aria-valuemax":e.max,"aria-valuenow":e.indeterminate?void 0:P.value,onClick:e.clickable&&j},{default:()=>[e.stream&&u("div",{class:["v-progress-linear__stream",l.value],style:V(y({},o.value),{[T.value?"left":"right"]:I(-C.value),borderTop:`${I(C.value/2)} dotted`,opacity:A.value,top:`calc(50% - ${I(C.value/4)})`,width:I(100-x.value,"%"),"--v-progress-linear-stream-to":I(C.value*(T.value?1:-1))})},null,6),u("div",{class:["v-progress-linear__background",c.value],style:[v.value,{opacity:A.value,width:I(e.stream?x.value:100,"%")}]},null,6),u(dt,{name:U.value},{default:()=>[e.indeterminate?u("div",{class:"v-progress-linear__indeterminate"},[["long","short"].map(B=>u("div",{key:B,class:["v-progress-linear__indeterminate",B,m.value],style:h.value},null,6))]):u("div",{class:["v-progress-linear__determinate",m.value],style:[h.value,{width:I(P.value,"%")}]},null,6)]},8,["name"]),t.default&&u("div",{class:"v-progress-linear__content"},[t.default({value:P.value,buffer:x.value})])],_:1},8,["class","style","aria-valuemax","aria-valuenow","onClick"])}}),Nn={props:["storyData"],data(){return{isReady:!1,renderBlocks:[]}},created(){this.$watch(()=>this.storyData,()=>{this.prepareRenderBlocks()},{immediate:!0})},methods:{prepareRenderBlocks(){var s;this.isReady=!1;let e=[],a=[],t,n;for(let r=0;r<this.storyData.lines.length;r++){let l=this.storyData.lines[r];switch(l.tag){case"DESCRIPTION":{t?t.tag==="DESCRIPTION"?t.params.text.push(l.params.text):(a.push(t),t={tag:"DESCRIPTION",params:{text:[l.params.text]}}):t={tag:"DESCRIPTION",params:{text:[l.params.text]}};break}case"CHARACTER_SPEECH":{t?t.tag==="CHARACTER_SPEECH"&&((s=t.params)==null?void 0:s.name.localeCompare(l.params.name,void 0,{sensitivity:"base"}))===0?t.params.text.push(l.params.text):(a.push(t),t={tag:"CHARACTER_SPEECH",params:V(y({},l.params),{text:[l.params.text]})}):t={tag:"CHARACTER_SPEECH",params:V(y({},l.params),{text:[l.params.text]})};break}case"DECISION":{t&&a.push(t);let o=l.params.options.split(";"),c=l.params.values.split(";"),v=!1;if(n){for(let m of c)if(n.options.includes(m)){v=!0;break}}v&&(e.push(a),a=[],t=null),(!n||v)&&(n={options:c}),t=V(y({},l),{params:{options:o.map((m,h)=>({text:m,value:c[h]}))}});break}case"PREDICATE":{t&&a.push(t);let o=l.params.references.split(";");t=V(y({},l),{params:{references:o}});break}case"IMAGE":{t&&a.push(t),t=l;break}case"BACKGROUND":{t&&a.push(t),t=l;break}}}a[a.length-1]!==t&&a.push(t),e[e.length-1]!==a&&e.push(a),this.renderBlocks=e,this.isReady=!0}},components:{RenderBlock:Bn}};function Mn(e,a,t,n,s,r){const l=D("RenderBlock");return d(),_(S,null,[s.isReady?k("",!0):(d(),g(Pe,{key:0,indeterminate:""})),u(J,null,{default:f(()=>[(d(!0),_(S,null,M(s.renderBlocks,(o,c)=>(d(),g(l,{key:c,renderBlock:o},null,8,["renderBlock"]))),128))]),_:1})],64)}var Fn=R(Nn,[["render",Mn]]);const Yn={props:["storyFile"],data(){return{loading:!0,storyData:{lines:[],tagCount:{}},storyInfo:void 0}},created(){this.$watch(()=>[this.storyFile],()=>{this.getStoryInfo()},{immediate:!0})},methods:{getStoryInfo(){this.storyFile.file&&(this.loading=!0,fetch(`${q}/story/${this.storyFile.server}/${this.storyFile.file}.txt`).then(e=>e.text().then(a=>{let t=hn(a);this.storyData=t,this.loading=!1})))}},components:{StoryReaderRender:Fn}};function Hn(e,a,t,n,s,r){const l=D("StoryReaderRender");return d(),_(S,null,[s.loading?(d(),g(Pe,{key:0,indeterminate:""})):k("",!0),s.loading?k("",!0):(d(),g(l,{key:1,storyData:s.storyData},null,8,["storyData"]))],64)}var Un=R(Yn,[["render",Hn]]);const jn={props:["storyType","storyId","storyIndex","server"],created(){this.getStoryTable()},data(){return{loading:!1,storyTable:{},storyFile:{file:"",server:""}}},methods:{getStoryTable(){this.loading=!0,fetch(`${q}/table/story_review_table.json`).then(e=>e.json()).then(e=>{this.storyTable=e,this.loading=!1})},selectFile({file:e,server:a}){this.storyFile={file:e,server:a}}},components:{StorySelector:gn,StoryReaderMain:Un}};function Wn(e,a,t,n,s,r){const l=D("StorySelector"),o=D("StoryReaderMain");return d(),_(S,null,[s.loading?(d(),g(Pe,{key:0,indeterminate:""})):k("",!0),s.loading?k("",!0):(d(),_(S,{key:1},[u(l,{storyTable:s.storyTable,onSelectFile:r.selectFile},null,8,["storyTable","onSelectFile"]),u(o,{storyFile:s.storyFile},null,8,["storyFile"])],64))],64)}var Gn=R(jn,[["render",Wn]]);export{Gn as default};

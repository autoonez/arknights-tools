import{u as b,H as A,a as I}from"./StoryReaderStore.925af092.js";import{d as N,r,aG as T,_ as w,c as f,w as l,o as u,a,ad as g,a3 as S,a5 as L,a4 as $,U as B,b as k}from"./index.039e7fc9.js";import{a as x,V as H,b as M,c as y,o as R}from"./VCard.923c5cea.js";import{V as C,a as q,b as D,c as E}from"./VWindowItem.4a906474.js";import{V as F}from"./ssrBoot.82cbcc40.js";import{V as U}from"./VBtn.885e87c3.js";import"./router.d4a02ace.js";import"./index.59fbb740.js";import"./forwardRefs.9af43674.js";const G=/.*\/docs.google.com\/spreadsheets\/d\/(?<spreadsheetId>.*)\/.*/g,P=N({name:"Google Sheets",setup(){const e=r(1),t=r(!1),v=r([]),n=r(""),i=r(""),d=r([]),o=T(),{setSpreadsheet:p}=b(),s=r();return{stage:e,isLoading:t,inputGoogleSheetUrl:i,selectedSheets:d,spreadsheet:s,errorMessage:n,goNext:async()=>{var m;if(e.value===1)if(i.value.match(G)){const c=G.exec(i.value);t.value=!0,n.value="",A.get(`https://sheets.googleapis.com/v4/spreadsheets/${(m=c==null?void 0:c.groups)==null?void 0:m.spreadsheetId}`,{params:{key:"AIzaSyDu129ufi2q02ZHJhoLYsO_0ew6nh9kQAQ"}}).then(h=>{s.value=h.data,t.value=!1,e.value=2}).catch(h=>{t.value=!1,h instanceof I.exports.AxiosError||v.value.push(h)})}else n.value="Invalid Google Sheets url";else e.value===2&&d.value.length>0&&s.value&&(p({id:s.value.spreadsheetId,url:s.value.spreadsheetUrl,title:s.value.properties.title,sheets:d.value,currentSheet:0}),o.push({name:"render-story",query:{type:"spreadsheet"}}))},selectAllSheets:()=>{s.value&&(d.value=s.value.sheets.map(m=>m.properties.title))}}}}),Q={key:0};function W(e,t,v,n,i,d){return u(),f(x,null,{default:l(()=>[a(H),e.isLoading?(u(),f(M,{key:0,indeterminate:""})):g("",!0),a(E,{modelValue:e.stage,"onUpdate:modelValue":t[2]||(t[2]=o=>e.stage=o)},{default:l(()=>[a(C,{value:1},{default:l(()=>[a(y,null,{default:l(()=>[a(q,{label:"Google Sheets Url","hide-details":"auto",modelValue:e.inputGoogleSheetUrl,"onUpdate:modelValue":t[0]||(t[0]=o=>e.inputGoogleSheetUrl=o)},null,8,["modelValue"]),e.errorMessage?(u(),S("p",Q,L(e.errorMessage),1)):g("",!0)]),_:1})]),_:1}),a(C,{value:2},{default:l(()=>[a(y,null,{default:l(()=>{var o;return[(u(!0),S(B,null,$((o=e.spreadsheet)==null?void 0:o.sheets,(p,s)=>(u(),f(D,{key:s,modelValue:e.selectedSheets,"onUpdate:modelValue":t[1]||(t[1]=V=>e.selectedSheets=V),label:p.properties.title,value:p.properties.title,"hide-details":"auto"},null,8,["modelValue","label","value"]))),128))]}),_:1})]),_:1})]),_:1},8,["modelValue"]),a(R,null,{default:l(()=>[a(F),e.stage===2?(u(),f(U,{key:0,onClick:e.selectAllSheets},{default:l(()=>[k("select all")]),_:1},8,["onClick"])):g("",!0),a(U,{onClick:e.goNext},{default:l(()=>[k("next")]),_:1},8,["onClick"])]),_:1})]),_:1})}const te=w(P,[["render",W]]);export{te as default};

var Dt=Object.defineProperty,Pt=Object.defineProperties;var At=Object.getOwnPropertyDescriptors;var ve=Object.getOwnPropertySymbols;var Ge=Object.prototype.hasOwnProperty,Ke=Object.prototype.propertyIsEnumerable;var Xe=(e,a,t)=>a in e?Dt(e,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[a]=t,h=(e,a)=>{for(var t in a||(a={}))Ge.call(a,t)&&Xe(e,t,a[t]);if(ve)for(var t of ve(a))Ke.call(a,t)&&Xe(e,t,a[t]);return e},V=(e,a)=>Pt(e,At(a));var Je=(e,a)=>{var t={};for(var n in e)Ge.call(e,n)&&a.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&ve)for(var n of ve(e))a.indexOf(n)<0&&Ke.call(e,n)&&(t[n]=e[n]);return t};import{_ as L}from"./index.37f8ae9b.js";import{o as u,c as _,w as f,t as S,u as w,h as re,a as o,k as O,v as P,x as ge,F as p,i as oe,y as J,z as ne,A as W,B as R,C as Bt,D as wt,E as Ae,G,H as Be,R as $t,I as ie,J as we,K as Vt,L as he,M as $e,N as mt,O as _e,P as Nt,Q,S as Yt,T as ce,U as Ve,W as Ft,X as Ht,Y as Se,Z as Ne,_ as ft,$ as pe,a0 as Mt,a1 as me,a2 as yt,a3 as Ut,a4 as Ye,a5 as Qe,a6 as ue,a7 as M,a8 as F,a9 as C,aa as Fe,ab as Z,ac as Wt,ad as U,ae as Ee,af as ee,ag as gt,ah as jt,ai as qt,aj as ht,ak as zt,al as Xt,am as I,an as xe,ao as Gt,ap as Kt,aq as Jt,ar as _t,as as Te,at as St,au as He,av as pt,aw as fe,ax as Qt,ay as Zt,az as ea,aA as Me,aB as le,aC as ta,aD as aa,aE as na,aF as sa,aG as Et,aH as la,aI as ra,aJ as oa,aK as ia,aL as ca,r as D,b as ua,aM as Ze,aN as et,n as Ie,m as Tt,aO as Re,aP as Ct}from"./vendor.3c8ea893.js";const X="/arknights-assets",Oe=[{id:"MAIN_STORY",name:"Main Theme"},{id:"ACTIVITY_STORY",name:"Public Affairs"},{id:"MINI_STORY",name:"Special Operation"},{id:"CHARACTER_STORY",name:"Operator Records"}],tt=[{id:"zh_CN",name:"China"},{id:"en_US",name:"Global"},{id:"ja_JP",name:"Japan"},{id:"ko_KR",name:"Korea"},{id:"zh_TW",name:"Taiwan"}],da={emits:["SELECT_TYPE"],data(){return{storyTypeList:Oe}}};function va(e,a,t,n,s,l){return u(),_(oe,null,{default:f(()=>[(u(!0),S(p,null,w(s.storyTypeList,(r,i)=>(u(),_(re,{key:i,onClick:c=>this.$emit("SELECT_TYPE",r.id)},{default:f(()=>[o(ge,null,{default:f(()=>[O(P(r.name),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})}var ma=L(da,[["render",va]]);const fa={props:["items","server","type","stage"],emits:["SELECT_HOME","SELECT_TYPE","SELECT_STORY_ID"],methods:{getStoryName(e){return`${e.code?`${e.code}: `:""}${e.name[this.server]}`}}},ya=O("mdi-home");function ga(e,a,t,n,s,l){return u(),S(p,null,[o(W,{variant:"text",class:ne({"d-none":t.type==="preview","d-none d-sm-inline-flex":t.type!=="preview"}),onClick:a[0]||(a[0]=r=>this.$emit("SELECT_HOME"))},{default:f(()=>[o(J,null,{default:f(()=>[ya]),_:1})]),_:1},8,["class"]),t.items.type?(u(),_(W,{key:0,variant:"text",class:ne({"d-none d-sm-inline-flex":t.type==="preview"||t.type!=="preview"&&t.stage!=="SELECT_STORY_ID"}),onClick:a[1]||(a[1]=r=>this.$emit("SELECT_TYPE",t.items.type.id))},{default:f(()=>[O(P(t.items.type.name),1)]),_:1},8,["class"])):R("",!0),t.items.episode?(u(),_(W,{key:1,variant:"text",class:ne({"d-none d-sm-inline-flex":t.type==="preview"||t.type!=="preview"&&t.stage!=="SELECT_STORY_INDEX"}),onClick:a[2]||(a[2]=r=>this.$emit("SELECT_STORY_ID",t.items.episode.id))},{default:f(()=>[O(P(t.items.episode.name[t.server]),1)]),_:1},8,["class"])):R("",!0),t.items.story?(u(),_(W,{key:2,variant:"text",class:ne({"d-none d-sm-inline-flex":t.type!=="preview"})},{default:f(()=>[O(P(l.getStoryName(t.items.story)),1)]),_:1},8,["class"])):R("",!0)],64)}var ha=L(fa,[["render",ga]]);const _a={props:["storyByChapter","server"],emits:["SELECT_STORY_ID"],methods:{getEpisode(e){return`Episode ${e.split("_")[1]}`},getImageSrc(e){return`${X}/images/storyEntryPic/main/zone_page_${e}.png`}}};function Sa(e,a,t,n,s,l){return u(!0),S(p,null,w(t.storyByChapter,(r,i)=>(u(),S(p,{key:i},[t.server in r.name?(u(),_(oe,{key:0},{default:f(()=>[o(Bt,null,{default:f(()=>[O(P(r.name[t.server]),1)]),_:2},1024),(u(!0),S(p,null,w(r.story,(c,d)=>(u(),_(re,{key:d,"prepend-avatar":l.getImageSrc(c.id),onClick:v=>this.$emit("SELECT_STORY_ID",c.id)},{default:f(()=>[o(Ae,null,{default:f(()=>[o(ge,null,{default:f(()=>[O(P(l.getEpisode(c.id)),1)]),_:2},1024),o(wt,null,{default:f(()=>[O(P(c.name[t.server]),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["prepend-avatar","onClick"]))),128))]),_:2},1024)):R("",!0)],64))),128)}var pa=L(_a,[["render",Sa]]);const Ea={props:["storyList","server"],emits:["SELECT_STORY_ID"],methods:{getImageSrc(e){return`${X}/images/storyEntryPic/activity/${e}.png`}}};function Ta(e,a,t,n,s,l){return u(),_(oe,null,{default:f(()=>[(u(!0),S(p,null,w(t.storyList,(r,i)=>(u(),S(p,{key:i},[t.server in r.name?(u(),_(re,{key:0,"prepend-avatar":l.getImageSrc(r.entryPic),onClick:c=>this.$emit("SELECT_STORY_ID",r.id)},{default:f(()=>[o(Ae,null,{default:f(()=>[o(ge,null,{default:f(()=>[O(P(r.name[t.server]),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["prepend-avatar","onClick"])):R("",!0)],64))),128))]),_:1})}var Ca=L(Ea,[["render",Ta]]);const ba={props:["storyList","server"],emits:["SELECT_STORY_INDEX"],methods:{getStoryName(e){return`${e.code?`${e.code}: `:""}${e.name[this.server]}`}}};function ka(e,a,t,n,s,l){return u(),_(oe,null,{default:f(()=>[(u(!0),S(p,null,w(t.storyList,(r,i)=>(u(),S(p,{key:i},[t.server in r.name?(u(),_(re,{key:0,onClick:c=>this.$emit("SELECT_STORY_INDEX",r.sort)},{default:f(()=>[o(Ae,null,{default:f(()=>[o(ge,null,{default:f(()=>[O(P(l.getStoryName(r)),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"])):R("",!0)],64))),128))]),_:1})}var xa=L(ba,[["render",ka]]);const Ia={props:["storyList","server"],emits:["SELECT_STORY_ID"],methods:{getImageSrc(e){return`${X}/images/avatar/${e}.png`}}};function Ra(e,a,t,n,s,l){return u(),_(oe,null,{default:f(()=>[(u(!0),S(p,null,w(t.storyList,(r,i)=>(u(),S(p,{key:i},[t.server in r.name?(u(),_(re,{key:0,"prepend-avatar":l.getImageSrc(r.character.id),onClick:c=>this.$emit("SELECT_STORY_ID",r.id),title:r.character.name[t.server],subtitle:r.name[t.server]},null,8,["prepend-avatar","onClick","title","subtitle"])):R("",!0)],64))),128))]),_:1})}var Oa=L(Ia,[["render",Ra]]);const La=G("v-card-actions"),at=G("v-card-avatar"),Da=G("v-card-header"),Pa=G("v-card-header-text"),Aa=G("v-card-img"),Ba=G("v-card-subtitle"),Ue=G("v-card-text"),wa=G("v-card-title"),We=Be({name:"VCard",directives:{Ripple:$t},props:h(h(h(h(h(h(h(h(h(h({appendAvatar:String,appendIcon:String,disabled:Boolean,flat:Boolean,hover:Boolean,image:String,link:Boolean,prependAvatar:String,prependIcon:String,ripple:Boolean,subtitle:String,text:String,title:String},ie()),we()),Vt()),he()),$e()),mt()),_e()),Nt()),Q()),Yt({variant:"contained"})),setup(e,a){let{attrs:t,slots:n}=a;const{themeClasses:s}=ce(e),{borderClasses:l}=Ve(e),{colorClasses:r,colorStyles:i,variantClasses:c}=Ft(e),{densityClasses:d}=Ht(e),{dimensionStyles:v}=Se(e),{elevationClasses:m}=Ne(e),{positionClasses:g,positionStyles:y}=ft(e),{roundedClasses:N}=pe(e),b=Mt(e,t);return()=>{var k,x,E;const Y=b.isLink.value?"a":e.tag,A=!!(n.title||e.title),j=!!(n.subtitle||e.subtitle),K=A||j,B=!!(n.append||e.appendAvatar||e.appendIcon),q=!!(n.prepend||e.prependAvatar||e.prependIcon),H=!!(n.image||e.image),z=K||q||B,T=!!(n.text||e.text),$=!e.disabled&&(b.isClickable.value||e.link);return me(o(Y,{class:["v-card",{"v-card--disabled":e.disabled,"v-card--flat":e.flat,"v-card--hover":e.hover&&!(e.disabled||e.flat),"v-card--link":$},s.value,l.value,r.value,d.value,m.value,g.value,N.value,c.value],style:[i.value,v.value,y.value],href:b.href.value,onClick:$&&b.navigate},{default:()=>[Ut($,"v-card"),H&&o(Aa,null,{default:()=>[n.image?(k=n.image)==null?void 0:k.call(n,{src:e.image}):o(Ye,{src:e.image,cover:!0,alt:""},null)]}),(x=n.media)==null?void 0:x.call(n),z&&o(Da,null,{default:()=>[q&&o(at,null,{default:()=>[n.prepend?n.prepend():o(Qe,{density:e.density,icon:e.prependIcon,image:e.prependAvatar},null)]}),K&&o(Pa,null,{default:()=>[A&&o(wa,null,{default:()=>[n.title?n.title():e.title]}),o(Ba,null,{default:()=>[n.subtitle?n.subtitle():e.subtitle]})]}),B&&o(at,null,{default:()=>[n.append?n.append():o(Qe,{density:e.density,icon:e.appendIcon,image:e.appendAvatar},null)]})]}),T&&o(Ue,null,{default:()=>[n.text?n.text():e.text]}),(E=n.default)==null?void 0:E.call(n),n.actions&&o(La,null,{default:n.actions})]}),[[yt("ripple"),$]])}}});const $a=ue({closeDelay:[Number,String],openDelay:[Number,String]},"delay");function Va(e,a){const t={},n=s=>()=>{if(!M)return Promise.resolve(!0);const l=s==="openDelay";return t.closeDelay&&window.clearTimeout(t.closeDelay),delete t.closeDelay,t.openDelay&&window.clearTimeout(t.openDelay),delete t.openDelay,new Promise(r=>{var i;const c=parseInt((i=e[s])!=null?i:0,10);t[s]=window.setTimeout(()=>{a==null||a(l),r(l)},c)})};return{runCloseDelay:n("closeDelay"),runOpenDelay:n("openDelay")}}const Na=ue(h({activator:[String,Object],activatorProps:{type:Object,default:()=>({})},openOnClick:{type:Boolean,default:void 0},openOnHover:Boolean,openOnFocus:{type:Boolean,default:void 0}},$a()));function Ya(e,a){const t=F();let n=!1,s=!1;const l=C(()=>e.openOnFocus||e.openOnFocus==null&&e.openOnHover),r=C(()=>e.openOnClick||e.openOnClick==null&&!e.openOnHover&&!l.value),{runOpenDelay:i,runCloseDelay:c}=Va(e,y=>{y===(e.openOnHover&&n||l.value&&s)&&(a.value=y)}),d={click:y=>{y.stopPropagation(),t.value=y.currentTarget||y.target,a.value=!a.value},mouseenter:y=>{n=!0,t.value=y.currentTarget||y.target,i()},mouseleave:y=>{n=!1,c()},focus:y=>{jt&&!y.target.matches(":focus-visible")||(s=!0,y.stopPropagation(),t.value=y.currentTarget||y.target,i())},blur:y=>{s=!1,y.stopPropagation(),c()}},v=C(()=>{const y={};return r.value&&(y.click=d.click),e.openOnHover&&(y.mouseenter=d.mouseenter,y.mouseleave=d.mouseleave),l.value&&(y.focus=d.focus,y.blur=d.blur),y}),m=F();Fe(()=>{!m.value||Z(()=>{const y=m.value;t.value=Wt(y)?y.$el:y})});let g;return U(()=>!!e.activator,y=>{y&&M?(g=Ee(),g.run(()=>{Fa(e,{activatorEl:t,activatorRef:m,activatorEvents:v})})):g&&g.stop()},{flush:"post",immediate:!0}),{activatorEl:t,activatorRef:m,activatorEvents:v}}function Fa(e,a){let{activatorEl:t,activatorEvents:n}=a;U(()=>e.activator,(c,d)=>{if(d&&c!==d){const v=i(d);v&&l(v)}c&&Z(()=>s())},{immediate:!0}),U(()=>e.activatorProps,()=>{s()}),ee(()=>{l()});function s(){let c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:i(),d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e.activatorProps;!c||(Object.entries(n.value).forEach(v=>{let[m,g]=v;c.addEventListener(m,g)}),Object.keys(d).forEach(v=>{d[v]==null?c.removeAttribute(v):c.setAttribute(v,d[v])}))}function l(){let c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:i(),d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e.activatorProps;!c||(Object.entries(n.value).forEach(v=>{let[m,g]=v;c.removeEventListener(m,g)}),Object.keys(d).forEach(v=>{c.removeAttribute(v)}))}const r=gt("useActivator");function i(){var c;let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:e.activator,v;if(d)if(d==="parent"){var m,g;v=r==null||(m=r.proxy)==null||(g=m.$el)==null?void 0:g.parentNode}else typeof d=="string"?v=document.querySelector(d):"$el"in d?v=d.$el:v=d;return t.value=((c=v)==null?void 0:c.nodeType)===Node.ELEMENT_NODE?v:null,t.value}}function nt(e){let[a,t]=e.split(" ");return t||(t=a==="top"||a==="bottom"?"start":a==="start"||a==="end"?"top":"center"),{side:a,align:t}}function Ce(e){return{side:{center:"center",top:"bottom",bottom:"top",start:"end",end:"start"}[e.side],align:e.align}}function st(e,a){var t,n;const{side:s,align:l}=e,{direction:r}=window.getComputedStyle(a),i=r==="ltr"?{start:"left",end:"right"}:{start:"right",end:"left"};return((t=i[s])!=null?t:s)+" "+((n=i[l])!=null?n:l)}function be(e,a){return{x:e.x+a.x,y:e.y+a.y}}function Ha(e,a){return{x:e.x-a.x,y:e.y-a.y}}function lt(e,a){if(e.side==="top"||e.side==="bottom"){const{side:t,align:n}=e,s=n==="start"?0:n==="center"?a.width/2:n==="end"?a.width:n,l=t==="top"?0:t==="bottom"?a.height:t;return be({x:s,y:l},a)}else if(e.side==="start"||e.side==="end"){const{side:t,align:n}=e,s=t==="start"?0:t==="end"?a.width:t,l=n==="top"?0:n==="center"?a.height/2:n==="bottom"?a.height:n;return be({x:s,y:l},a)}return be({x:a.width/2,y:a.height/2},a)}const bt={static:Wa,connected:ja},Ma=ue({positionStrategy:{type:[String,Function],default:"static",validator:e=>typeof e=="function"||e in bt},anchor:{type:String,default:"bottom"},origin:{type:String,default:"auto"},offset:[Number,String]});function Ua(e,a){const t=F({}),n=F();let s;Fe(async()=>{var r;(r=s)==null||r.stop(),n.value=void 0,!!(M&&a.isActive.value&&e.positionStrategy)&&(s=Ee(),await Z(),s.run(()=>{if(typeof e.positionStrategy=="function"){var i;n.value=(i=e.positionStrategy(a,e,t))==null?void 0:i.updatePosition}else{var c;n.value=(c=bt[e.positionStrategy](a,e,t))==null?void 0:c.updatePosition}}))}),M&&window.addEventListener("resize",l,{passive:!0}),ee(()=>{var r;M&&window.removeEventListener("resize",l),n.value=void 0,(r=s)==null||r.stop()});function l(r){var i;(i=n.value)==null||i.call(n,r)}return{contentStyles:t,updatePosition:n}}function Wa(){}function ja(e,a,t){const n=qt(e.activatorEl.value);n&&Object.assign(t.value,{position:"fixed"});const s=C(()=>nt(a.anchor)),l=C(()=>a.origin==="overlap"?s.value:a.origin==="auto"?Ce(s.value):nt(a.origin)),r=C(()=>s.value.side===l.value.side),i=C(()=>{const m=parseFloat(a.maxHeight);return isNaN(m)?1/0:m}),c=C(()=>{const m=parseFloat(a.minWidth);return isNaN(m)?1/0:m});let d=!1;if(M){const m=new ResizeObserver(()=>{d&&v()});m.observe(e.activatorEl.value),m.observe(e.contentEl.value),ee(()=>{m.disconnect()})}function v(){d=!1,requestAnimationFrame(()=>{requestAnimationFrame(()=>d=!0)});const m=e.activatorEl.value.getBoundingClientRect();a.offset&&(m.x-=+a.offset,m.y-=+a.offset,m.width+=+a.offset*2,m.height+=+a.offset*2);const g=ht(e.contentEl.value),y=g.clientWidth,N=Math.min(g.clientHeight,window.innerHeight);let b;{const qe=new Map;e.contentEl.value.querySelectorAll("*").forEach(te=>{const de=te.scrollLeft,ze=te.scrollTop;(de||ze)&&qe.set(te,[de,ze])});const Ot=e.contentEl.value.style.maxWidth,Lt=e.contentEl.value.style.maxHeight;e.contentEl.value.style.removeProperty("max-width"),e.contentEl.value.style.removeProperty("max-height"),b=zt(e.contentEl.value),b.x-=parseFloat(e.contentEl.value.style.left)||0,b.y-=parseFloat(e.contentEl.value.style.top)||0,e.contentEl.value.style.maxWidth=Ot,e.contentEl.value.style.maxHeight=Lt,qe.forEach((te,de)=>{de.scrollTo(...te)})}const k=Math.min(i.value,b.height),x=12,E={top:m.top-x,bottom:N-m.bottom-x,left:m.left-x,right:y-m.right-x},Y=s.value.side==="bottom"&&k<=E.bottom||s.value.side==="top"&&k<=E.top,A=Y?s.value:s.value.side==="bottom"&&E.top>E.bottom||s.value.side==="top"&&E.bottom>E.top?Ce(s.value):s.value,j=Y?l.value:Ce(A),B=r.value||["center","top","bottom"].includes(A.side)?Math.min(y,Math.max(m.width,y-x*2)):A.side==="end"?E.right:A.side==="start"?E.left:null,q=Math.min(c.value,B,m.width),H=Y?i.value:Math.min(i.value,Math.floor(A.side==="top"?E.top:E.bottom)),z=lt(A,m),T=lt(j,new Xt(V(h({},b),{height:Math.min(k,H)}))),{x:$,y:Rt}=Ha(z,T);Object.assign(t.value,{"--v-overlay-anchor-origin":st(A,e.activatorEl.value),top:I(Math.round(Rt)),left:I(Math.round($)),transformOrigin:st(j,e.activatorEl.value),minWidth:I(q),maxWidth:I(B),maxHeight:I(H)})}return U(()=>[s.value,l.value,a.offset],()=>v(),{immediate:!n}),n&&Z(()=>v()),requestAnimationFrame(()=>{t.value.maxHeight&&v()}),{updatePosition:v}}let Le=!0;const ye=[];function qa(e){!Le||ye.length?(ye.push(e),De()):(Le=!1,e(),De())}let rt=-1;function De(){cancelAnimationFrame(rt),rt=requestAnimationFrame(()=>{const e=ye.shift();e&&e(),ye.length?De():Le=!0})}const Pe={close:Ga,block:Ka,reposition:Ja},za=ue({scrollStrategy:{type:[String,Function],default:"block",validator:e=>typeof e=="function"||e in Pe}});function Xa(e,a){if(!M)return;let t;Fe(async()=>{var n;(n=t)==null||n.stop(),!!(a.isActive.value&&e.scrollStrategy)&&(t=Ee(),await Z(),t.run(()=>{if(typeof e.scrollStrategy=="function")e.scrollStrategy(a);else{var s;(s=Pe[e.scrollStrategy])==null||s.call(Pe,a)}}))})}function Ga(e){var a;function t(n){e.isActive.value=!1}kt((a=e.activatorEl.value)!=null?a:e.contentEl.value,t)}function Ka(e){var a;const t=[...new Set([...xe(e.activatorEl.value),...xe(e.contentEl.value)])].filter(l=>!l.classList.contains("v-overlay-scroll-blocked")),n=window.innerWidth-document.documentElement.offsetWidth,s=(l=>Gt(l)&&l)(((a=e.root.value)==null?void 0:a.offsetParent)||document.documentElement);s&&e.root.value.classList.add("v-overlay--scroll-blocked"),t.forEach((l,r)=>{l.style.setProperty("--v-scrollbar-offset",I(n)),l.classList.add("v-overlay-scroll-blocked")}),ee(()=>{t.forEach((l,r)=>{l.style.removeProperty("--v-scrollbar-offset"),l.classList.remove("v-overlay-scroll-blocked")}),s&&e.root.value.classList.remove("v-overlay--scroll-blocked")})}function Ja(e){var a;let t=!1,n=-1;function s(l){qa(()=>{var r,i;const c=performance.now();(r=(i=e.updatePosition).value)==null||r.call(i,l),t=(performance.now()-c)/(1e3/60)>2})}kt((a=e.activatorEl.value)!=null?a:e.contentEl.value,l=>{t?(cancelAnimationFrame(n),n=requestAnimationFrame(()=>{n=requestAnimationFrame(()=>{s(l)})})):s(l)})}function kt(e,a){const t=[document,...xe(e)];t.forEach(n=>{n.addEventListener("scroll",a,{passive:!0})}),ee(()=>{t.forEach(n=>{n.removeEventListener("scroll",a)})})}function se(e){return{teleportTarget:C(()=>{const t=e.value;if(t===!0||!M)return;const n=t===!1?document.body:typeof t=="string"?document.querySelector(t):t;if(n==null){Kt(`Unable to locate target ${t}`);return}if(!se.cache.has(n)){const s=document.createElement("div");s.className="v-overlay-container",n.appendChild(s),se.cache.set(n,s)}return se.cache.get(n)})}}se.cache=new WeakMap;const Qa=ue({eager:Boolean},"lazy");function Za(e,a){const t=F(!1),n=C(()=>t.value||e.eager||a.value);U(a,()=>t.value=!0);function s(){e.eager||(t.value=!1)}return{isBooted:t,hasContent:n,onAfterLeave:s}}const ae=F([]);function en(e){const a=gt("useStack");let t;return U(e,s=>{if(s)t=Ee(),t.run(()=>{ae.value.push(a),ee(()=>{const r=ae.value.indexOf(a);ae.value.splice(r,1)})});else{var l;(l=t)==null||l.stop()}},{immediate:!0}),{isTop:C(()=>Jt(ae.value[ae.value.length-1])===a)}}function tn(){return!0}function xt(e,a,t){if(!e||It(e,t)===!1)return!1;const n=_t(a);if(typeof ShadowRoot!="undefined"&&n instanceof ShadowRoot&&n.host===e.target)return!1;const s=(typeof t.value=="object"&&t.value.include||(()=>[]))();return s.push(a),!s.some(l=>l==null?void 0:l.contains(e.target))}function It(e,a){return(typeof a.value=="object"&&a.value.closeConditional||tn)(e)}function an(e,a,t){const n=typeof t.value=="function"?t.value:t.value.handler;a._clickOutside.lastMousedownWasOutside&&xt(e,a,t)&&setTimeout(()=>{It(e,t)&&n&&n(e)},0)}function ot(e,a){const t=_t(e);a(document),typeof ShadowRoot!="undefined"&&t instanceof ShadowRoot&&a(t)}const nn={mounted(e,a){const t=s=>an(s,e,a),n=s=>{e._clickOutside.lastMousedownWasOutside=xt(s,e,a)};ot(e,s=>{s.addEventListener("click",t,!0),s.addEventListener("mousedown",n,!0)}),e._clickOutside||(e._clickOutside={lastMousedownWasOutside:!0}),e._clickOutside[a.instance.$.uid]={onClick:t,onMousedown:n}},unmounted(e,a){!e._clickOutside||(ot(e,t=>{var n;if(!t||!((n=e._clickOutside)!=null&&n[a.instance.$.uid]))return;const{onClick:s,onMousedown:l}=e._clickOutside[a.instance.$.uid];t.removeEventListener("click",s,!0),t.removeEventListener("mousedown",l,!0)}),delete e._clickOutside[a.instance.$.uid])}};function sn(e){const s=e,{modelValue:a,color:t}=s,n=Je(s,["modelValue","color"]);return o(Et,{name:"fade-transition",appear:!0},{default:()=>[e.modelValue&&o("div",le({class:["v-overlay__scrim",e.color.backgroundColorClasses.value],style:e.color.backgroundColorStyles.value},n),null)]})}const ln=Te()({name:"VOverlay",directives:{ClickOutside:nn},inheritAttrs:!1,props:h(h(h(h(h(h(h({absolute:Boolean,attach:[Boolean,String,Object],contained:Boolean,contentClass:null,noClickAnimation:Boolean,modelValue:Boolean,persistent:Boolean,scrim:{type:[String,Boolean],default:!0}},Na()),he()),Ma()),za()),ie()),St()),Qa()),emits:{"click:outside":e=>!0,"update:modelValue":e=>!0},setup(e,a){let{slots:t,attrs:n,emit:s}=a;const l=He(e,"modelValue"),{teleportTarget:r}=se(C(()=>e.attach||e.contained)),{themeClasses:i}=ce(e),{rtlClasses:c}=pt(),{hasContent:d,onAfterLeave:v}=Za(e,l),m=fe(C(()=>typeof e.scrim=="string"?e.scrim:null)),{activatorEl:g,activatorRef:y,activatorEvents:N}=Ya(e,l),{dimensionStyles:b}=Se(e),{isTop:k}=en(l),x=F(),E=F(),{contentStyles:Y,updatePosition:A}=Ua(e,{contentEl:E,activatorEl:g,isActive:l});Xa(e,{root:x,contentEl:E,activatorEl:g,isActive:l,updatePosition:A});function j(T){s("click:outside",T),e.persistent?H():l.value=!1}function K(){return l.value&&k.value}M&&U(l,T=>{T?window.addEventListener("keydown",B):window.removeEventListener("keydown",B)},{immediate:!0});function B(T){T.key==="Escape"&&k.value&&(e.persistent?H():l.value=!1)}Qt(T=>{k.value&&l.value?(T(!1),e.persistent?H():l.value=!1):T()});const q=F();U(()=>l.value&&(e.absolute||e.contained)&&r.value==null,T=>{if(T){const $=ht(x.value);$&&$!==document.scrollingElement&&(q.value=$.scrollTop)}});function H(){var T;e.noClickAnimation||(T=E.value)==null||T.animate([{transformOrigin:"center"},{transform:"scale(1.03)"},{transformOrigin:"center"}],{duration:150,easing:Zt})}const{overlayZIndex:z}=ea(l);return Me(()=>{var T,$;return o(p,null,[(T=t.activator)==null?void 0:T.call(t,{isActive:l.value,props:le({ref:y},ta(N.value),e.activatorProps)}),M&&o(aa,{disabled:!r.value,to:r.value},{default:()=>[d.value&&o("div",le({class:["v-overlay",{"v-overlay--absolute":e.absolute||e.contained,"v-overlay--active":l.value,"v-overlay--contained":e.contained},i.value,c.value],style:{top:I(q.value),zIndex:z.value},ref:x},n),[o(sn,{color:m,modelValue:l.value&&!!e.scrim},null),o(na,{appear:!0,onAfterLeave:v,persisted:!0,transition:e.transition,target:g.value},{default:()=>[me(o("div",{ref:E,class:["v-overlay__content",e.contentClass],style:[b.value,Y.value]},[($=t.default)==null?void 0:$.call(t,{isActive:l})]),[[sa,l.value],[yt("click-outside"),{handler:j,closeConditional:K,include:()=>[g.value]}]])]})])]})])}),{animateClick:H,contentEl:E,activatorEl:g}}}),rn=Te()({name:"VDialog",inheritAttrs:!1,props:h(h({fullscreen:Boolean,origin:{type:String,default:"center center"},retainFocus:{type:Boolean,default:!0},scrollable:Boolean,modelValue:Boolean},he({width:"auto"})),St({transition:{component:la}})),emits:{"update:modelValue":e=>!0},setup(e,a){let{attrs:t,slots:n}=a;const s=He(e,"modelValue"),{dimensionStyles:l}=Se(e),r=F();function i(c){var d;const v=c.relatedTarget,m=c.target;if(v!==m&&(d=r.value)!=null&&d.contentEl&&![document,r.value.contentEl].includes(m)&&!r.value.contentEl.contains(m)){const g=[...r.value.contentEl.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])')].filter(b=>!b.hasAttribute("disabled"));if(!g.length)return;const y=g[0],N=g[g.length-1];v===y?N.focus():y.focus()}}return M&&U(()=>s.value&&e.retainFocus,c=>{c?document.addEventListener("focusin",i):document.removeEventListener("focusin",i)},{immediate:!0}),U(s,async c=>{if(await Z(),c){var d;(d=r.value.contentEl)==null||d.focus({preventScroll:!0})}else{var v;(v=r.value.activatorEl)==null||v.focus({preventScroll:!0})}}),()=>o(ln,le({modelValue:s.value,"onUpdate:modelValue":c=>s.value=c,class:["v-dialog",{"v-dialog--fullscreen":e.fullscreen}],style:l.value,transition:e.transition,ref:r,"aria-role":"dialog","aria-modal":"true",activatorProps:{"aria-haspopup":"dialog","aria-expanded":String(s.value)}},t),{default:n.default,activator:n.activator})}});const on=Be({name:"VFooter",props:h(h(h(h(h(h(h(h({},we()),he()),$e()),mt()),_e()),Q()),Q({tag:"footer"})),ie()),setup(e,a){let{slots:t}=a;const{themeClasses:n}=ce(e),{borderClasses:s}=Ve(e),{dimensionStyles:l}=Se(e),{elevationClasses:r}=Ne(e),{positionClasses:i,positionStyles:c}=ft(e),{roundedClasses:d}=pe(e);return()=>o(e.tag,{class:["v-footer",n.value,s.value,r.value,i.value,d.value],style:[l.value,c.value]},t)}});function cn(e){const a=F(),t=F(!1),n=new IntersectionObserver(s=>{e==null||e(s,n),t.value=!!s.find(l=>l.isIntersecting)});return ra(()=>{n.disconnect()}),U(a,(s,l)=>{l&&(n.unobserve(l),t.value=!1),s&&n.observe(s)},{flush:"post"}),{intersectionRef:a,isIntersecting:t}}const je=Be({name:"VProgressLinear",props:h(h(h({active:{type:Boolean,default:!0},bgColor:String,bgOpacity:[Number,String],bufferValue:{type:[Number,String],default:0},clickable:Boolean,color:String,height:{type:[Number,String],default:4},indeterminate:Boolean,max:{type:[Number,String],default:100},modelValue:{type:[Number,String],default:0},reverse:Boolean,stream:Boolean,striped:Boolean,roundedBar:Boolean},_e()),Q()),ie()),emits:{"update:modelValue":e=>!0},setup(e,a){let{slots:t}=a;const n=He(e,"modelValue"),{isRtl:s}=pt(),{themeClasses:l}=ce(e),{textColorClasses:r,textColorStyles:i}=oa(e,"color"),{backgroundColorClasses:c,backgroundColorStyles:d}=fe(C(()=>e.bgColor||e.color)),{backgroundColorClasses:v,backgroundColorStyles:m}=fe(e,"color"),{roundedClasses:g}=pe(e),{intersectionRef:y,isIntersecting:N}=cn(),b=C(()=>parseInt(e.max,10)),k=C(()=>parseInt(e.height,10)),x=C(()=>parseFloat(e.bufferValue)/b.value*100),E=C(()=>parseFloat(n.value)/b.value*100),Y=C(()=>s.value!==e.reverse),A=C(()=>e.indeterminate?"fade-transition":"slide-x-transition"),j=C(()=>e.bgOpacity==null?e.bgOpacity:parseFloat(e.bgOpacity));function K(B){if(!y.value)return;const{left:q,right:H,width:z}=y.value.getBoundingClientRect(),T=Y.value?z-B.clientX+(H-z):B.clientX-q;n.value=Math.round(T/z*b.value)}return()=>o(e.tag,{ref:y,class:["v-progress-linear",{"v-progress-linear--active":e.active&&N.value,"v-progress-linear--reverse":Y.value,"v-progress-linear--rounded":e.rounded,"v-progress-linear--rounded-bar":e.roundedBar,"v-progress-linear--striped":e.striped},g.value,l.value],style:{height:e.active?I(k.value):0,"--v-progress-linear-height":I(k.value)},role:"progressbar","aria-valuemin":"0","aria-valuemax":e.max,"aria-valuenow":e.indeterminate?void 0:E.value,onClick:e.clickable&&K},{default:()=>[e.stream&&o("div",{class:["v-progress-linear__stream",r.value],style:V(h({},i.value),{[Y.value?"left":"right"]:I(-k.value),borderTop:`${I(k.value/2)} dotted`,opacity:j.value,top:`calc(50% - ${I(k.value/4)})`,width:I(100-x.value,"%"),"--v-progress-linear-stream-to":I(k.value*(Y.value?1:-1))})},null),o("div",{class:["v-progress-linear__background",c.value],style:[d.value,{opacity:j.value,width:I(e.stream?x.value:100,"%")}]},null),o(Et,{name:A.value},{default:()=>[e.indeterminate?o("div",{class:"v-progress-linear__indeterminate"},[["long","short"].map(B=>o("div",{key:B,class:["v-progress-linear__indeterminate",B,v.value],style:m.value},null))]):o("div",{class:["v-progress-linear__determinate",v.value],style:[m.value,{width:I(E.value,"%")}]},null)]}),t.default&&o("div",{class:"v-progress-linear__content"},[t.default({value:E.value,buffer:x.value})])]})}}),un=[null,"prominent","default","comfortable","compact"],ke=Te()({name:"VToolbar",props:h(h(h(h(h({absolute:Boolean,collapse:Boolean,color:String,density:{type:String,default:"default",validator:e=>un.includes(e)},extended:Boolean,extensionHeight:{type:[Number,String],default:48},flat:Boolean,floating:Boolean,height:{type:[Number,String],default:64},image:String,title:String},we()),$e()),_e()),Q({tag:"header"})),ie()),setup(e,a){let{slots:t}=a;const{borderClasses:n}=Ve(e),{elevationClasses:s}=Ne(e),{roundedClasses:l}=pe(e),{themeClasses:r}=ce(e),{backgroundColorClasses:i,backgroundColorStyles:c}=fe(ia(e,"color")),d=C(()=>Number(e.height)+(e.density==="prominent"?Number(e.height):0)-(e.density==="comfortable"?8:0)-(e.density==="compact"?16:0));return ca({VBtn:{flat:!0,variant:"text"},VTextField:{hideDetails:!0}},{scoped:!0}),Me(()=>{var v,m,g,y,N;const b=!!(e.title||t.title),k=!!(t.image||e.image),x=!!(e.extended||t.extension);return o(e.tag,{class:["v-toolbar",{"v-toolbar--absolute":e.absolute,"v-toolbar--collapse":e.collapse,"v-toolbar--flat":e.flat,"v-toolbar--floating":e.floating,[`v-toolbar--density-${e.density}`]:!0},i.value,n.value,s.value,l.value,r.value],style:[c.value]},{default:()=>[k&&o("div",{class:"v-toolbar__image"},[t.image?(v=t.image)==null?void 0:v.call(t,{src:e.image}):o(Ye,{src:e.image,cover:!0},null)]),o("div",{class:"v-toolbar__content",style:{height:I(d.value)}},[t.prepend&&o("div",{class:"v-toolbar__prepend"},[(m=t.prepend)==null?void 0:m.call(t)]),b&&o(dn,{text:e.title},{text:t.title}),(g=t.default)==null?void 0:g.call(t),t.append&&o("div",{class:"v-toolbar__append"},[(y=t.append)==null?void 0:y.call(t)])]),x&&o("div",{class:"v-toolbar__extension",style:{height:I(e.extensionHeight)}},[(N=t.extension)==null?void 0:N.call(t)])]})}),{}}}),dn=Te()({name:"VToolbarTitle",props:h({text:String},Q()),setup(e,a){let{slots:t}=a;return Me(()=>{var n;const s=!!(t.text||e.text);return o(e.tag,{class:"v-toolbar-title"},{default:()=>[s&&o("div",{class:"v-toolbar-title__placeholder"},[t.text?t.text():e.text]),(n=t.default)==null?void 0:n.call(t)]})}),{}}}),vn={props:["storyTable"],emits:["selectFile"],data(){return{dialog:!1,ready:!1,stage:"SELECT_TYPE",story:{type:"",id:"",index:1},server:"en_US",serverList:tt}},created(){this.$watch(()=>[this.$route.query.storyType,this.$route.query.storyId,this.$route.query.storyIndex,this.$route.query.server],()=>{this.getUrlQuery()},{immediate:!0})},computed:{stageComponent(){let e="TYPE";return this.stage==="SELECT_STORY_ID"&&this.story.type==="MAIN_STORY"&&(e="MAIN"),this.stage==="SELECT_STORY_ID"&&["ACTIVITY_STORY","MINI_STORY"].includes(this.story.type)&&(e="ACTIVITY"),this.stage==="SELECT_STORY_ID"&&this.story.type==="CHARACTER_STORY"&&(e="CHARACTER"),this.stage==="SELECT_STORY_INDEX"&&(e="INDEX"),e}},methods:{getUrlQuery(){let e=this.$route.query,a=!1,t="en_US",n;if(e.server&&tt.find(s=>s.id===e.server)&&(this.server=e.server),t=e.server,e.storyType&&Oe.find(s=>s.id===e.storyType)){let s=e.storyType;if(this.story.type=s,e.storyId&&e.storyId in this.storyTable.story[s]){let l=e.storyId,r=this.storyTable.story[s][l];if(t in r.name){this.story.id=l;let i;e.storyIndex&&(i=r.story.find(c=>c.sort===parseInt(e.storyIndex)))&&(this.story.index=i.sort,n=i.file,a=!0)}}}a?this.$emit("selectFile",{file:n,server:this.server}):this.dialog=!0},getMainStoryByChapter(){let e=Object.entries(this.storyTable.story.MAIN_STORY).reduce((a,[t,n])=>{if(!(n.chapter in a)){let s=this.storyTable.data.chapter[n.chapter];a[n.chapter]={id:n.chapter,name:s.name,story:[]}}return a[n.chapter].story.push(V(h({},n),{id:t})),a},{});return Object.values(e)},getActivityStoryList(){return Object.entries(this.storyTable.story[this.story.type]).map(([e,a])=>V(h({},a),{id:e}))},getCharacterStoryList(){return Object.entries(this.storyTable.story.CHARACTER_STORY).map(([e,a])=>{let t=this.storyTable.data.character[a.character];return V(h({},a),{id:e,character:{id:a.character,name:t.name}})})},getStoryList(){return this.storyTable.story[this.story.type][this.story.id].story},getBreadcrumbItems(){let e,a,t;return e=Oe.find(n=>n.id===this.story.type),e&&(a=this.storyTable.story[this.story.type][this.story.id]),a&&(t=a.story.find(n=>n.sort===this.story.index)),{type:e,episode:a?V(h({},a),{id:this.story.id}):void 0,story:t?V(h({},t),{index:this.story.index}):void 0}},selectHome(){this.ready=!1,this.stage="SELECT_TYPE",this.story={}},selectType(e){this.ready=!1,this.stage="SELECT_STORY_ID",this.story={type:e}},selectStoryId(e){this.ready=!1,this.stage="SELECT_STORY_INDEX",this.story={type:this.story.type,id:e}},selectStoryIndex(e){this.story={type:this.story.type,id:this.story.id,index:e},this.ready=!0},select(){this.dialog=!1,this.$router.push({path:"/story-reader",query:{storyType:this.story.type,storyId:this.story.id,storyIndex:this.story.index,server:this.server}})},goBack(){this.ready=!1,this.stage==="SELECT_STORY_INDEX"?this.stage="SELECT_STORY_ID":this.stage="SELECT_TYPE"}},components:{StorySelectorType:ma,StorySelectorBreadcrumb:ha,StorySelectorMain:pa,StorySelectorActivity:Ca,StorySelectorIndex:xa,StorySelectorCharacter:Oa}},mn=O("mdi-close"),fn=O("mdi-earth"),yn=["value"],gn=O("Select"),hn=O("mdi-close"),_n=O("mdi-earth"),Sn=["value"],pn=O("mdi-chevron-left"),En=O("Select");function Tn(e,a,t,n,s,l){const r=D("StorySelectorBreadcrumb"),i=D("StorySelectorType"),c=D("StorySelectorMain"),d=D("StorySelectorActivity"),v=D("StorySelectorCharacter"),m=D("StorySelectorIndex");return u(),_(rn,{modelValue:s.dialog,"onUpdate:modelValue":a[7]||(a[7]=g=>s.dialog=g),scrim:!1,transition:"dialog-bottom-transition",fullscreen:"",scrollable:"",class:"dialog"},{activator:f(({props:g})=>[o(ua,le({density:"compact"},g),{default:f(()=>[o(r,{items:l.getBreadcrumbItems(),server:s.server,type:"preview"},null,8,["items","server"])]),_:2},1040)]),default:f(()=>[o(We,null,{default:f(()=>[o(ke,{density:"compact",class:"d-none d-sm-flex"},{default:f(()=>[o(W,{icon:"",dark:"",onClick:a[0]||(a[0]=g=>s.dialog=!1)},{default:f(()=>[o(J,null,{default:f(()=>[mn]),_:1})]),_:1}),o(r,{items:l.getBreadcrumbItems(),server:s.server,stage:s.stage,onSELECT_HOME:l.selectHome,onSELECT_TYPE:l.selectType},null,8,["items","server","stage","onSELECT_HOME","onSELECT_TYPE"]),o(Ze),o(J,null,{default:f(()=>[fn]),_:1}),me(Ie("select",{"onUpdate:modelValue":a[1]||(a[1]=g=>s.server=g)},[(u(!0),S(p,null,w(s.serverList,(g,y)=>(u(),S("option",{key:y,value:g.id},P(g.name),9,yn))),128))],512),[[et,s.server]]),o(W,{disabled:!s.ready,variant:"outlined",text:"",onClick:a[2]||(a[2]=g=>l.select())},{default:f(()=>[gn]),_:1},8,["disabled"])]),_:1}),o(ke,{density:"compact",class:"d-flex d-sm-none"},{default:f(()=>[o(W,{icon:"",dark:"",onClick:a[3]||(a[3]=g=>s.dialog=!1)},{default:f(()=>[o(J,null,{default:f(()=>[hn]),_:1})]),_:1}),o(r,{items:l.getBreadcrumbItems(),server:s.server,stage:s.stage,onSELECT_HOME:l.selectHome,onSELECT_TYPE:l.selectType},null,8,["items","server","stage","onSELECT_HOME","onSELECT_TYPE"])]),_:1}),o(ke,{density:"compact",class:"d-flex d-sm-none"},{default:f(()=>[o(J,null,{default:f(()=>[_n]),_:1}),me(Ie("select",{"onUpdate:modelValue":a[4]||(a[4]=g=>s.server=g)},[(u(!0),S(p,null,w(s.serverList,(g,y)=>(u(),S("option",{key:y,value:g.id},P(g.name),9,Sn))),128))],512),[[et,s.server]])]),_:1}),o(Tt,{class:"dialog-container overflow-auto my-3"},{default:f(()=>[l.stageComponent==="TYPE"?(u(),_(i,{key:0,onSELECT_TYPE:l.selectType},null,8,["onSELECT_TYPE"])):R("",!0),l.stageComponent==="MAIN"?(u(),_(c,{key:1,storyByChapter:l.getMainStoryByChapter(),server:s.server,onSELECT_STORY_ID:l.selectStoryId},null,8,["storyByChapter","server","onSELECT_STORY_ID"])):R("",!0),l.stageComponent==="ACTIVITY"?(u(),_(d,{key:2,storyList:l.getActivityStoryList(),server:s.server,onSELECT_STORY_ID:l.selectStoryId},null,8,["storyList","server","onSELECT_STORY_ID"])):R("",!0),l.stageComponent==="CHARACTER"?(u(),_(v,{key:3,storyList:l.getCharacterStoryList(),server:s.server,onSELECT_STORY_ID:l.selectStoryId},null,8,["storyList","server","onSELECT_STORY_ID"])):R("",!0),l.stageComponent==="INDEX"?(u(),_(m,{key:4,storyList:l.getStoryList(),server:s.server,onSELECT_STORY_INDEX:l.selectStoryIndex},null,8,["storyList","server","onSELECT_STORY_INDEX"])):R("",!0)]),_:1}),o(on,{bottom:"",fixed:"",border:"",height:"48px",class:"footer d-flex d-sm-none",width:"100%"},{default:f(()=>[o(W,{variant:"text",onClick:a[5]||(a[5]=g=>l.goBack())},{default:f(()=>[o(J,null,{default:f(()=>[pn]),_:1})]),_:1}),o(Ze),o(W,{disabled:!s.ready,variant:"outlined",text:"",onClick:a[6]||(a[6]=g=>l.select())},{default:f(()=>[En]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}var Cn=L(vn,[["render",Tn]]);const it=/\[(?<tag>.+?)\((?<params>.*)\)\]/,ct=/\[(?<tag>.*)=(?<value>.*)\]/g,ut=/\[(?<tag>.*)\]/,dt=/(?<name>\w*?)\s*=\s*(?<value>".*?"|[^",)\]\s]*)/g,vt=/\[[Nn][Aa][Mm][Ee]="(?<name>.*)"(?<params>.*)\]\s*(?<text>.*)/g,bn=e=>{let a={lines:[],tagCount:{},otherLines:[]},t=e.split(`
`),n=s=>{s in a.tagCount||(a.tagCount[s]=0),a.tagCount[s]+=1};for(const s of t)if(s.match(it)){let{tag:l,params:r}=it.exec(s).groups;l=l.toUpperCase();let i={},c;for(;(c=dt.exec(r))!==null;){let{name:d,value:v}=c.groups;i[d]=v.replace(/"/g,"")}a.lines.push({tag:l,params:i}),n(l)}else if(s.match(vt)){let{name:l,params:r,text:i}=vt.exec(s).groups,c={},d;for(;(d=dt.exec(r))!==null;){let{name:v,value:m}=d.groups;c[v]=m.replace(/"/g,"")}a.lines.push({tag:"CHARACTER_SPEECH",params:V(h({},c),{name:l,text:i})}),n("CHARACTER_SPEECH")}else if(s.match(ct)){let{tag:l,value:r}=ct.exec(s).groups;l=l.toUpperCase(),a.lines.push({tag:l,params:{[l]:r}}),n(l)}else if(s.match(ut)){let{tag:l}=ut.exec(s).groups;l=l.toUpperCase(),a.lines.push({tag:l,params:{}}),n(l)}else if(s.length>0&&s.indexOf("//"!==0)){let l="DESCRIPTION";a.lines.push({tag:l,params:{text:s}}),n(l)}else a.otherLines.push(s);return a},kn={props:["line"]};function xn(e,a,t,n,s,l){return u(),_(We,{class:"my-3"},{default:f(()=>[o(Ue,{style:{"font-size":"1rem","line-height":"1.5rem"}},{default:f(()=>[(u(!0),S(p,null,w(t.line.params.text,(r,i)=>(u(),S("p",{key:i},P(r),1))),128))]),_:1})]),_:1})}var In=L(kn,[["render",xn]]);const Rn={props:["line"]},On={class:"font-weight-bold text-grey"};function Ln(e,a,t,n,s,l){return u(),_(Ct,{class:"my-3"},{default:f(()=>[o(Re,{cols:"12",sm:"2",class:"pb-0 pb-sm-3"},{default:f(()=>[Ie("p",On,P(t.line.params.name),1)]),_:1}),o(Re,{cols:"12",sm:"8",class:"pt-0 pt-sm-3"},{default:f(()=>[(u(!0),S(p,null,w(t.line.params.text,(r,i)=>(u(),S("p",{key:i,class:ne({"mt-1":i>0})},P(r),3))),128))]),_:1})]),_:1})}var Dn=L(Rn,[["render",Ln]]);const Pn={props:["line","decision"],emits:["selectDecision"],methods:{getVariant(e){let a="contained";return(this.decision[this.line.params.id]||this.line.params.options[0].value)===e&&(a="outlined"),a},selectDecision(e){this.$emit("selectDecision",{id:this.line.params.id,value:e})}}};function An(e,a,t,n,s,l){return u(),_(Ct,{dense:""},{default:f(()=>[(u(!0),S(p,null,w(t.line.params.options,(r,i)=>(u(),_(Re,{cols:"12",key:i},{default:f(()=>[o(W,{class:"float-right text-right",variant:l.getVariant(r.value),onClick:c=>l.selectDecision(r.value)},{default:f(()=>[O(P(r.text),1)]),_:2},1032,["variant","onClick"])]),_:2},1024))),128))]),_:1})}var Bn=L(Pn,[["render",An]]);const wn={props:["line"],computed:{imageSrc(){let e="";return this.line.tag==="IMAGE"&&(e=`${X}/images/avg/imgs/${this.line.params.image}.png`),this.line.tag==="BACKGROUND"&&(e=`${X}/images/avg/bg/${this.line.params.image}.png`),this.line.params.image||(e=e=`${X}/images/avg/bg/bg_black.png`),e}}};function $n(e,a,t,n,s,l){return u(),_(Ye,{src:l.imageSrc,class:"my-3"},null,8,["src"])}var Vn=L(wn,[["render",$n]]);const Nn={props:["line"]};function Yn(e,a,t,n,s,l){return u(),_(We,{class:"my-3"},{default:f(()=>[o(Ue,{class:"text-center",style:{"font-size":"1rem","line-height":"1.5rem"}},{default:f(()=>[(u(!0),S(p,null,w(t.line.params.text,(r,i)=>(u(),S("p",{key:i},P(r),1))),128))]),_:1})]),_:1})}var Fn=L(Nn,[["render",Yn]]);const Hn={props:["line","decision"],emits:["selectDecision"],methods:{selectDecision(e){this.$emit("selectDecision",e)}},components:{TagDescription:In,TagCharacterSpeech:Dn,TagDecision:Bn,TagImage:Vn,TagSubtitle:Fn}};function Mn(e,a,t,n,s,l){const r=D("TagDescription"),i=D("TagSubtitle"),c=D("TagCharacterSpeech"),d=D("TagDecision"),v=D("TagImage");return t.line.tag==="DESCRIPTION"?(u(),_(r,{key:0,line:t.line},null,8,["line"])):t.line.tag==="SUBTITLE"?(u(),_(i,{key:1,line:t.line},null,8,["line"])):t.line.tag==="CHARACTER_SPEECH"?(u(),_(c,{key:2,line:t.line},null,8,["line"])):t.line.tag==="DECISION"?(u(),_(d,{key:3,line:t.line,decision:t.decision,onSelectDecision:l.selectDecision},null,8,["line","decision","onSelectDecision"])):["IMAGE","BACKGROUND"].includes(t.line.tag)?(u(),_(v,{key:4,line:t.line},null,8,["line"])):R("",!0)}var Un=L(Hn,[["render",Mn]]);const Wn={props:["renderBlock"],data(){return{decision:{}}},methods:{selectDecision({id:e,value:a}){this.decision[e]=a}},computed:{items(){let e=[],a=1,t;for(let n=0;n<this.renderBlock.length;n++){let s=this.renderBlock[n];switch(s.tag){case"DECISION":{t=this.decision[a]||s.params.options[0].value,s.params.id=a,e.push(s),a+=1;break}case"PREDICATE":{if(s.params.references.includes(t))t=null;else for(let l=n+1;l<this.renderBlock.length;l++)if(this.renderBlock[l].tag==="PREDICATE"){n=l-1;break}else if(l===this.renderBlock.length-1){n=l;break}break}default:{e.push(s);break}}}return e}},components:{StoryReaderRenderItem:Un}};function jn(e,a,t,n,s,l){const r=D("StoryReaderRenderItem");return u(!0),S(p,null,w(l.items,(i,c)=>(u(),_(r,{key:c,line:i,decision:s.decision,onSelectDecision:l.selectDecision},null,8,["line","decision","onSelectDecision"]))),128)}var qn=L(Wn,[["render",jn]]);const zn={props:["storyData"],data(){return{isReady:!1,renderBlocks:[]}},created(){this.$watch(()=>this.storyData,()=>{this.prepareRenderBlocks()},{immediate:!0})},methods:{prepareRenderBlocks(){var s;this.isReady=!1;let e=[],a=[],t,n;for(let l=0;l<this.storyData.lines.length;l++){let r=this.storyData.lines[l];switch(r.tag){case"DESCRIPTION":{t?t.tag==="DESCRIPTION"?t.params.text.push(r.params.text):(a.push(t),t={tag:"DESCRIPTION",params:{text:[r.params.text]}}):t={tag:"DESCRIPTION",params:{text:[r.params.text]}};break}case"SUBTITLE":{r.params.text&&(t?t.tag==="SUBTITLE"?t.params.text.push(r.params.text):(a.push(t),t={tag:"SUBTITLE",params:{text:[r.params.text]}}):t={tag:"SUBTITLE",params:{text:[r.params.text]}});break}case"CHARACTER_SPEECH":{t?t.tag==="CHARACTER_SPEECH"&&((s=t.params)==null?void 0:s.name.localeCompare(r.params.name,void 0,{sensitivity:"base"}))===0?t.params.text.push(r.params.text):(a.push(t),t={tag:"CHARACTER_SPEECH",params:V(h({},r.params),{text:[r.params.text]})}):t={tag:"CHARACTER_SPEECH",params:V(h({},r.params),{text:[r.params.text]})};break}case"DECISION":{t&&a.push(t);let i=r.params.options.split(";"),c=r.params.values.split(";"),d=!1;if(n){for(let v of c)if(n.options.includes(v)){d=!0;break}}d&&(e.push(a),a=[],t=null),(!n||d)&&(n={options:c}),t=V(h({},r),{params:{options:i.map((v,m)=>({text:v,value:c[m]}))}});break}case"PREDICATE":{t&&a.push(t);let i=r.params.references.split(";");t=V(h({},r),{params:{references:i}});break}case"IMAGE":{t&&a.push(t),t=r;break}case"BACKGROUND":{t&&a.push(t),t=r;break}}}a[a.length-1]!==t&&a.push(t),e[e.length-1]!==a&&e.push(a),this.renderBlocks=e,this.isReady=!0}},components:{RenderBlock:qn}};function Xn(e,a,t,n,s,l){const r=D("RenderBlock");return u(),S(p,null,[s.isReady?R("",!0):(u(),_(je,{key:0,indeterminate:""})),o(Tt,null,{default:f(()=>[(u(!0),S(p,null,w(s.renderBlocks,(i,c)=>(u(),_(r,{key:c,renderBlock:i},null,8,["renderBlock"]))),128))]),_:1})],64)}var Gn=L(zn,[["render",Xn]]);const Kn={props:["storyFile"],data(){return{loading:!0,storyData:{lines:[],tagCount:{}},storyInfo:void 0}},created(){this.$watch(()=>[this.storyFile],()=>{this.getStoryInfo()},{immediate:!0})},methods:{getStoryInfo(){this.storyFile.file&&(this.loading=!0,fetch(`${X}/story/${this.storyFile.server}/${this.storyFile.file}.txt`).then(e=>e.text().then(a=>{let t=bn(a);this.storyData=t,this.loading=!1})))}},components:{StoryReaderRender:Gn}};function Jn(e,a,t,n,s,l){const r=D("StoryReaderRender");return u(),S(p,null,[s.loading?(u(),_(je,{key:0,indeterminate:""})):R("",!0),s.loading?R("",!0):(u(),_(r,{key:1,storyData:s.storyData},null,8,["storyData"]))],64)}var Qn=L(Kn,[["render",Jn]]);const Zn={props:["storyType","storyId","storyIndex","server"],created(){this.getStoryTable()},data(){return{loading:!1,storyTable:{},storyFile:{file:"",server:""}}},methods:{getStoryTable(){this.loading=!0,fetch(`${X}/table/story_review_table.json`).then(e=>e.json()).then(e=>{this.storyTable=e,this.loading=!1})},selectFile({file:e,server:a}){this.storyFile={file:e,server:a}}},components:{StorySelector:Cn,StoryReaderMain:Qn}};function es(e,a,t,n,s,l){const r=D("StorySelector"),i=D("StoryReaderMain");return u(),S(p,null,[s.loading?(u(),_(je,{key:0,indeterminate:""})):R("",!0),s.loading?R("",!0):(u(),S(p,{key:1},[o(r,{storyTable:s.storyTable,onSelectFile:l.selectFile},null,8,["storyTable","onSelectFile"]),o(i,{storyFile:s.storyFile},null,8,["storyFile"])],64))],64)}var ss=L(Zn,[["render",es]]);export{ss as default};
